"use strict";!function(e,t){var n=n||{};n.AdUnit=function(e,t,n,i){function o(e){n.Observable.call(this),this.id=u++,this.product=e.product,this.settings=e.settings,this.templateSettings=e.templateSettings,this.closeDelay=e.closeDelay||p,this.renderOptions=e.renderOptions,this.creativeLoad=e.creativeLoad,this.templateLoad=e.templateLoad||l,this.render=e.render,this.open=e.open,this.close=e.close,this.body=null,this.status=s.CLOSED,this.openCount=0,this.openTime=null,this.scheduledClose=!1,this.closeTimer=null,this.on(c.OPEN,function(e){this.status===s.CLOSING?this.once(c.CLOSED,this._open,this):this._open(e)},this),this.on(c.CLOSE,this._close,this),this.on(c.RENDER,this._render,this),this.on(c.SCHEDULE_CLOSE,this._scheduleClose,this),this.on(c.SHOW,this.show,this),this.on(c.HIDE,this.hide,this)}function a(e){return new o(e)}var c={LOAD:"load",LOADED:"loaded",OPEN:"open",OPENING:"opening",OPENED:"opened",CONTROLLEDOPEN:"adunit:controlledopen",CLICK:"adunit:click",CLOSE:"close",CLOSING:"closing",CLOSED:"closed",SHOW:"show",HIDE:"hide",RENDER:"render",RENDERING:"rendering",RENDERED:"rendered",SCHEDULE_CLOSE:"scheduleClose",MOUSEIN:"adunit:mousein",MOUSEOUT:"adunit:mouseout",DELEGATE:"delegate"},s={CLOSED:0,CLOSING:1,OPENING:2,OPEN:3},d={body:".vm-adunit-body"},u=1,l=function(e,t,n){i.load(e,t,n)},p=3e3;return o.prototype=new n.Observable,o.prototype.EVENT_MOUSEIN=c.MOUSEIN,o.prototype.EVENT_MOUSEOUT=c.MOUSEOUT,o.prototype.EVENT_CLICK=c.CLICK,o.prototype.EVENT_OPENED=c.OPENED,o.prototype.EVENT_CLOSED=c.CLOSED,o.prototype.EVENT_DELEGATE=c.DELEGATE,o.prototype.CONTROLLED_OPEN=c.CONTROLLEDOPEN,o.prototype.getAdConfig=function(){return this.settings},o.prototype.getAd=function(){return this.getAdConfig().ads[0]},o.prototype.getDiyValues=function(){var e=this.getAd();return e.creative.diyValues||{}},o.prototype.getPosition=function(){return t.getPosition(this.outerBox)},o.prototype.getWidth=function(){return this.creative.getWidth()},o.prototype.getHeight=function(){return this.creative.getHeight()},o.prototype.getClickDelay=function(){var e=this.getDiyValues();return e.clickdelay?parseInt(e.clickdelay,10)||0:0},o.prototype.getBodyContainer=function(){return this.outerBox.querySelector(d.body)},o.prototype.getOpenCount=function(){return this.openCount},o.prototype.isOpen=function(){return this.status===s.OPEN||this.status===s.OPENING},o.prototype.isReady=function(){return this.status===s.OPEN},o.prototype.isInViewport=function(){return t.isInViewport(this.outerBox)},o.prototype.cancelScheduledClose=function(){this.closeTimer&&(e.clearTimeout(this.closeTimer),this.closeTimer=null),this.scheduledClose=!1},o.prototype._render=function(){var e=this;this.fire(c.RENDERING),this.render(this,function(t){t||e.fire(c.RENDERED)})},o.prototype._open=function(e){var t=isNaN(e.data)?r.Log.viewSource.LOAD:e.data,n=this;this.status===s.CLOSED&&(this.status=s.OPENING,this.fire(c.OPENING),this.once(c.LOADED,function(e){var i=e.data;return i?(n.body=i,n.once(c.RENDERED,function(){n.open(n,t,function(e){e||(n.status=s.OPEN,n.openTime=+new Date,++n.openCount,n.fire(c.OPENED,t))})}),void n.fire(c.RENDER)):void(n.status=s.CLOSED)}),this.creative?this.creative.fire(c.LOAD,this.template):this.templateLoad(this.templateSettings,this.settings,function(e,t){n.template=t,n.creative=n.creativeLoad(n),n.creative.connect(c.LOADED,n),n.creative.connect(c.LOAD,n),n.creative.fire(c.LOAD,t)}))},o.prototype._close=function(e){var t=isNaN(e.data)?r.Log.closeSource.AUTO:e.data,n=this;this.status===s.OPEN&&(this.status=s.CLOSING,this.fire(c.CLOSING),this.close(this,t,function(e){e||(n.status=s.CLOSED,n.openTime=null,n.fire(c.CLOSED,t))}),this.cancelScheduledClose())},o.prototype._scheduleClose=function(t){function n(){o.closeTimer=e.setTimeout(function(){o.fire(c.CLOSE,i)},o.closeDelay)}var i=t.data,o=this;switch(this.cancelScheduledClose(),this.status){case s.OPEN:n(),this.scheduledClose=!0;break;case s.OPENING:this.once(c.OPENED,function(){o.scheduledClose&&n()}),this.scheduledClose=!0}},o.prototype.show=function(){this.outerBox&&(this.outerBox.style.visibility="visible")},o.prototype.hide=function(){this.outerBox&&(this.outerBox.style.visibility="hidden")},{AdInstance:o,create:a}};var n=n||{};n.CPEUnit=function(e,t,n,i,o,r){function a(){return d.Wrapper({config:t,dom:n,events:i,log:o,utils:r})}function c(t){e.VM.CPE=e.VM.CPE||{},e.VM.CPE.initialise=t,n.appendStyleSheet(l),n.appendScript(u),p=!0}function s(e,t){d?a().run(e,t):(h.push({args:e,callback:t}),p||c(function(e){d=e,r.forEach(h,function(e){a().run(e.args,e.callback)}),p=!1,h=[]}))}var d,u="//"+t.get("cdn.cpewrapperjs"),l="//"+t.get("cdn.cpewrappercss"),p=!1,h=[];return{load:s}};var n=n||{};n.Creative=function(e,t){function n(){e.Observable.call(this);var t=this;this.on(o.LOAD,function(e){t.load(e)},this)}function i(e){return t.extend(new n,e)}var o={LOADED:"loaded",LOAD:"load"};return n.prototype=new e.Observable,n.prototype.getWidth=function(){return this.width},n.prototype.getHeight=function(){return this.height},n.prototype.load=function(){throw new Error("not implemented")},{CreativeInterface:n,create:i}};var n=n||{};n.CustomUnit=function(e,n,i,o,a,c,s){function d(e,t){return e.VM=e.VM||{},new s(e,t,n,i,o,a,c)}function u(e,t,n){var i=c.debounce(function(){t.fire("start")},p),a=c.debounce(function(){t.fire("stop")},p),s=e.getDiyValues().nohookclick||!1,d=c.debounce(function(n,i){var a;i===r.Log.clickSource.HOOK&&s||(a=e.getClickDelay(),n instanceof Event?o.stopPropagation(n):n&&n.event instanceof Event&&o.stopPropagation(n.event),c.timeDeltaPassed(e.openTime,a,function(){t.fire("click")}))},p);e.on(e.EVENT_OPENED,i),e.on(e.EVENT_MOUSEIN,i),e.on(e.EVENT_CLOSED,a),e.on(e.EVENT_MOUSEOUT,a),e.on(e.EVENT_CLICK,function(e){var t=e.data instanceof MouseEvent?e.data:e.data.event,n=t.srcElement.className===h?r.Log.clickSource.HOOK:r.Log.clickSource.AD;d(t,n)}),e.on(e.EVENT_CLOSED,function(){t.unbindAll(),n.parentNode&&n.parentNode.removeChild(n)}),e.on(e.EVENT_DELEGATE,function(e){"hover"===e.data.triggerSource?i():"click"===e.data.triggerSource&&d()})}function l(s,l){var p=s.adInstance,h=s.templateData,f=s.channel||new o.Observable,g=p.getAd(),v=p.getAdConfig(),m={product:p.product,hookId:v.vibrantParameters.hookId,keyword:encodeURIComponent(v.term&&v.term.keyword||""),timestamp:+new Date,clickUrl:g.clickUrl,source:r.Log.clickSource.AD},y=c.extend({},h.params,g.creative.diyValues||{},{clickUrl:a.getUrl("clickThrough",m)}),b=i.createIFrame({width:y.width,height:y.height},function(r,s){s.contentWindow.contents=decodeURIComponent(h.template),s.creativeAPI={adInstance:p,channel:f,config:n,dom:i,events:o,log:a,utils:c,videoplayer:d,template:{id:h.id,params:y,template:h.template},window:e,document:t},u(p,f,s),s.src="javascript:window['contents']"});l({width:y.width,height:y.height,element:b})}var p=100,h="vm-hook";return{load:l}};var n=n||{};n.Decoration=function(e,t,n,i,o,a,c){function s(e){return g[e]||g.standard}function d(e,t,n){return"inview"===t&&(n="inview"),f.hasOwnProperty(n)?e.style.zIndex=f[n]:e.style.zIndex=f.fallback,e}function u(e,n){var i,o,r,a,c=t.createElement("div");return n=n||{},n.settings=n.settings||e.settings,c.innerHTML=s(n.decorationType).replace(/\{id\}/g,e.id),a=c.firstChild,i=a.querySelectorAll(".vm-adunit-close, .vm-inview-close"),o=a.querySelector(".vm-adunit-adchoice"),r=a.querySelector(".vm-adunit-body"),r.appendChild(e.body),a=d(a,n.decorationType,e.product),e.outerBox=e.position.placeOuterBox(e,a),e=l(e,{outerBox:a,adunitClose:i,adunitAdChoice:o})}function l(e,t){return i.bindConnect(t.outerBox,"mouseenter",e,e.EVENT_MOUSEIN),i.bindConnect(t.outerBox,"mouseleave",e,e.EVENT_MOUSEOUT),a.isEmpty(t.adunitClose)||a.forEach(t.adunitClose,function(t){i.bind(t,"click",function(t){i.stopPropagation(t),e.fire("close",r.Log.closeSource.AD)})}),t.adunitAdChoice&&i.bind(t.adunitAdChoice,"click",function(t){i.stopPropagation(t),c.adChoiceClick({product:e.product,hookId:e.settings.vibrantParameters.hookId}),o.openUrl(p)}),e}var p="http://www.vibrantmedia.com/whatisIntelliTXT.asp",h=n.getBoolean("partner.inview.headerclose",!1),f={intext:n.getInteger("partner.intext.zindex",5999999),image:n.getInteger("partner.image.zindex",1999999),daw:n.getInteger("partner.daw.zindex",5e6),adhesion:n.getInteger("partner.adhesion.zindex",5e6),adbar:n.getInteger("partner.adbar.zindex",5e6),inline:n.getInteger("partner.inline.zindex",4999),inview:n.getInteger("partner.inview.zindex",4999),fallback:n.getInteger("partner.fallback.zindex",1e6)},g={standard:['<div id="vm-adunit-outer-{id}" class="vm-adunit-outer">','<div class="vm-adunit-close vm-close-top"></div>','<div class="vm-adunit-adchoice vm-adchoice-top"></div>','<div id="vm-adunit-inner-{id}" class="vm-adunit-inner">','<div id="vm-adunit-content-{id}" class="vm-adunit-content">','<div id="vm-adunit-head-{id}" class="vm-adunit-head"></div>','<div id="vm-adunit-body-{id}" class="vm-adunit-body vm-adunit-loading">',"</div>",'<div id="vm-adunit-foot-{id}" class="vm-adunit-foot"></div>',"</div>","</div>","</div>"].join("\n"),legacyadhesion:['<div id="vm-adunit-outer-{id}" class="vm-adunit-outer legacyadhesion">','<div class="vm-adunit-close" style="background-position: -60px 0px;"></div>','<div class="vm-adunit-adchoice vm-adchoice-top"></div>','<div id="vm-adunit-inner-{id}" class="vm-adunit-inner">','<div id="vm-adunit-content-{id}" class="vm-adunit-content">','<div id="vm-adunit-head-{id}" class="vm-adunit-head"></div>','<div id="vm-adunit-body-{id}" class="vm-adunit-body vm-adunit-loading">',"</div>",'<div id="vm-adunit-foot-{id}" class="vm-adunit-foot"></div>',"</div>","</div>","</div>"].join("\n"),image:['<div id="vm-adunit-outer-{id}" class="vm-adunit-outer">','<div class="vm-adunit-close vm-close-base"></div>','<div class="vm-adunit-adchoice vm-adchoice-base"></div>','<div id="vm-adunit-inner-{id}" class="vm-adunit-inner vm-no-shadow">','<div id="vm-adunit-content-{id}" class="vm-adunit-content">','<div id="vm-adunit-head-{id}" class="vm-adunit-head"></div>','<div id="vm-adunit-body-{id}" class="vm-adunit-body vm-body-clear">',"</div>",'<div id="vm-adunit-foot-{id}" class="vm-adunit-foot"></div>',"</div>","</div>","</div>"].join("\n"),cpeProgressBar:['<div id="vm-adunit-outer-{id}" class="vm-adunit-outer">','<div id="vm-adunit-inner-{id}">','<div id="vm-adunit-content-{id}" class="vm-adunit-content">','<div id="vm-adunit-head-{id}" class="vm-adunit-head"></div>','<div id="vm-adunit-body-{id}" class="vm-adunit-body"></div>','<div id="vm-adunit-foot-{id}" class="vm-adunit-foot"></div>',"</div>","</div>","</div>"].join("\n"),cpeDropIn:['<div id="vm-adunit-outer-{id}" class="vm-adunit-outer" style="display: none">','<div id="vm-adunit-inner-{id}">','<div id="vm-adunit-content-{id}" class="vm-adunit-content">','<div id="vm-adunit-head-{id}" class="vm-adunit-head"></div>','<div id="vm-adunit-body-{id}" class="vm-adunit-body"></div>','<div id="vm-adunit-foot-{id}" class="vm-adunit-foot"></div>',"</div>","</div>","</div>"].join("\n"),chrome:['<div id="vm-adunit-outer-{id}" class="vm-adunit-outer">','<div id="vm-tt-header-{id}" class="vm-tt-header" style="height: 30px;">','<div class="vm-tt-sprite-header">','<div class="vm-tt-sprite12-tlc vm-tt-sprite12"></div>','<div class="vm-tt-sprite12-tm vm-tt-sprite12"></div>','<div class="vm-tt-sprite12-trc vm-tt-sprite12"></div>',"</div>",'<div class="vm-tt-hdr-lft">','<a target="_blank" class="vm-tt-vmlogo-a">','<div class="vm-tt-vmlogo12"></div>',"</a>",'<div class="vm-tt-priv12 vm-adunit-adchoice" style="display: block;">','<div class="vm-tt-adchoices12"></div>','<div class="vm-tt-adchoices12-txt">AdChoices</div>',"</div>","</div>",'<div class=" vm-tt-hdr-rt">','<div class="vm-adunit-close" style="background-position: -60px 0px;"></div>',"</div>","</div>",'<div style="background-color: rgb(240, 240, 240);" class="vm-tt-content-bg">','<div class="vm-tt-sprite12-lft-edge" style="display: block;"></div>','<div class="vm-tt-sprite12-rt-edge" style="display: block;"></div>',"</div>",'<div id="vm-adunit-inner-{id}" class="vm-adunit-inner" style="padding-left: 5px;padding-right: 5px;padding-top: 30px;">','<div id="vm-adunit-content-{id}" class="vm-adunit-content">','<div id="vm-adunit-head-{id}" class="vm-adunit-head"></div>','<div id="vm-adunit-body-{id}" class="vm-adunit-body vm-adunit-loading">',"</div>",'<div id="vm-adunit-foot-{id}" class="vm-adunit-foot"></div>',"</div>","</div>",'<div id="vm-tt-footer" style="width: 100%; height: 6px; background-color: transparent;">','<div class="vm-tt-footer12">','<div class="vm-tt-footer12-left vm-tt-sprite12"></div>','<div class="vm-tt-footer12-mid vm-tt-sprite12"></div>','<div class="vm-tt-footer12-right vm-tt-sprite12"></div>',"</div>","</div>","</div>"].join("\n"),inview:['<div id="vm-adunit-outer-{id}" class="vm-adunit-outer vm-inview">','<div class="vm-inview-header '+(h?"vm-inview-close":"")+'">',"ADVERTISEMENT",'<div class="vm-adunit-close">','<div class="vm-close-icon"></div>',"</div>","</div>",'<div id="vm-adunit-inner-{id}" class="vm-adunit-inner">','<div id="vm-adunit-content-{id}" class="vm-adunit-content">','<div id="vm-adunit-body-{id}" class="vm-adunit-body">',"</div>","</div>","</div>",'<div class="vm-inview-footer">','<div class="vm-adunit-adchoice"></div>','<div class="vm-inview-poweredby"></div>',"</div>","</div>"].join("\n")};return{decorate:u}};var n=n||{};n.Position=function(e,t,n,i,o,a){function c(e){this.positionFunc=e}function s(e,t){this.position=e,this.animate=t.animate,this.controlledOpen=t.controlledOpen,this.animationTime=500}function d(e){this.element=e,this.openTransitionEnabled=!0,this.closeTransitionEnabled=!0}function u(e){this.hook=e,this.openTransitionEnabled=!0,this.closeTransitionEnabled=!0}var l=100,p=300,h="-9999px",f=60;return c.prototype.placeOuterBox=function(n,r){var a=this;r.className+=" vm-adunit-absolute",r.style.top=h,r.style.left=h,r.style.visibility="hidden",r.style.opacity=0;var c=r.querySelector(".vm-adunit-body");c.style.width=n.getWidth()+"px",c.style.height=n.getHeight()+"px";var s=o.debounce(function(){var e=a.positionFunc();r.style.top=e.top+"px",r.style.left=e.left+"px"},l,{leading:!0});return n.once("opened",function(){r=t.body.appendChild(r),s(),a.unbindResizeEvent=i.bind(e,"resize",s),n.on("domChange",s),r.style.visibility="visible",r.style.opacity=1}),n.once("closing",function(){a.unbindResizeEvent&&(a.unbindResizeEvent(),delete a.unbindResizeEvent),n.unbind("domChange",s),r.style.visibility="hidden",r.style.opacity=0}),n.once("closed",function(){r.style.top=h,r.style.left=h,t.body.removeChild(r)}),r},s.prototype.placeOuterBox=function(i,r){var a,c=this;r.className+=" vm-adunit-fixed",r.style.top=h,r.style.left=h,r.style.bottom="",r.style.right="",r.style.visibility="hidden",r.style.opacity=0;var s=r.querySelector(".vm-adunit-body");return s.style.width=i.getWidth()+"px",s.style.height=i.getHeight()+"px",i.once("opened",function(){function s(){c.animate?(a=n.getStyle(r).height,r.style.bottom="-"+a,r.style.visibility="visible",r.style.opacity=1,e.setTimeout(function(){r.className+=" vm-adunit-fixed-animate",r.style.bottom="0px"},c.animationTime)):(r.style.visibility="visible",r.style.opacity=1)}o.forEach(["top","left","bottom","right"],function(e){c.position.hasOwnProperty(e)?r.style[e]=c.position[e]+"px":r.style[e]=""}),""===r.style.left&&""===r.style.right&&(r.style.left="50%",r.style.marginLeft=-i.getWidth()/2+"px"),r=t.body.appendChild(r),c.controlledOpen?i.on(i.CONTROLLED_OPEN,s):s()}),i.once("closing",function(){c.animate?r.style.bottom="-"+a:(r.style.visibility="hidden",r.style.opacity=0)}),i.once("closed",function(){c.animate?e.setTimeout(function(){r.style.visibility="hidden",r.style.top=h,r.style.left=h,t.body.removeChild(r)},c.animationTime):(r.style.top=h,r.style.left=h,t.body.removeChild(r))}),r},d.prototype.placeOuterBox=function(t,n){function c(){n.style.maxHeight="500px",a.fire(r.app.inline.animationEnd)}n=this.element.parentNode.insertBefore(n,this.element.nextSibling);var s=n.querySelector(".vm-adunit-body");return a.fire(r.app.inline.animationStart),n.className+=" vm-adunit-inline",n.style.width=t.getWidth()+"px",s.style.width=t.getWidth()+"px",s.style.height=t.getHeight()+"px",this.openTransitionEnabled?(n.style.maxHeight="0px",e.setTimeout(c,1)):c(),t.once("closed",function(){var t,r=o.once(function(){t&&t(),n.parentNode.removeChild(n)});this.closeTransitionEnabled?(n.style.maxHeight="0px",o.isIE?e.setTimeout(r,p):t=i.bind(n,"transitionend",r)):r()},this),n},u.prototype.placeOuterBox=function(t,c){function s(){u&&u(),a.fire(r.app.inview.animationEnd)}var d,u,l=this.hook.getDomNode(),h=this.hook.getParagraphPosition(),g=t.getHeight()+f,v=c.querySelector(".vm-adunit-body");return a.fire(r.app.inview.animationStart),o.isIE?e.setTimeout(s,p):u=i.bind(c,"transitionend",s),l.className+=" vm-hook-inview",c.className+=" vm-adunit-inview",v.style.width=t.getWidth()+"px",v.style.height=t.getHeight()+"px",c.style.maxHeight="0px",l.style.marginBottom="0px",e.setTimeout(function(){c.style.maxHeight=g+"px",l.style.marginBottom=g+"px"},1),d=n.getPosition(l),c.style.top=d.bottom-d.top+"px",c.style.left=h.left-d.left+"px",c.style.width=h.right-h.left+"px",t.once("closed",function(){var t;a.fire(r.app.inview.animationStart);var n=o.once(function(){t&&t(),a.fire(r.app.inview.animationEnd),c.parentNode.removeChild(c)});c.style.maxHeight="0px",l.style.marginBottom="0px",o.isIE?e.setTimeout(n,p):t=i.bind(c,"transitionend",n)},this),l.appendChild(c)},{Absolute:c,Fixed:s,Inline:d,Inview:u}};var n=n||{};n.Template=function(t,n){function i(e){this.id=e.id,this.params=e.params||{},this.template=e.template||""}function o(e,n,o){var c;"undefined"!=typeof a[e.id]?o(null,a[e.id]):"c2s"===n.ads[0].creative.creativeType?(c=new i({id:e.id,params:{c2s:!0}}),o(null,c)):n.ads[0].creative.payload?(c=new i(n.ads[0].creative.payload),a[e.id]=c,o(null,c)):t.jsonp({scope:r,url:e.cdnUrl,id:e.id}).on("data",function(t){var n=t.data,r=new i(n);a[e.id]=r,o(null,r)})}var r="template",a={};return i.prototype.execute=function(t){return t=n.extend({},this.params,t||{},{source:e.location,timestamp:+new Date,creativeId:this.id}),n.replaceUrlParams(this.template,t)},{CachedTemplate:i,load:o}};var n=n||{};n.VideoUnit=function(e,t,n,i,o,r,a){function c(e,t,c,s){var d=u({config:n,dom:i,events:o,log:r,utils:a});return"function"==typeof t&&"undefined"==typeof s&&(s=c,c=t),"videoFrame"===s?d.videoFrame.create(e,c):d.player.create(e,t,c)}function s(n){var i=t.head||t.getElementsByTagName("head")[0],o=t.createElement("script");e.VM.videoplayer=e.VM.videoplayer||{},e.VM.videoplayer.initialise=n,o.type="text/javascript",o.async=!0,o.src=h,i.appendChild(o),l=!0}function d(e,t,n,i){u?c(e,t,n,i):(p.push({args:e,id:t,callback:n,unit:i}),l||s(function(e){u=e,a.forEach(p,function(e){c(e.args,e.id,e.callback,e.unit)}),l=!1,p=[]}))}var u,l=!1,p=[],h="//"+n.get("cdn.videoplayerjs");return{load:d}};var i=i||{};i.AdBarLegacy=function(e,n,i){function o(){var n=t.createElement("div");n.id=a,n.setAttribute("data-adtech",""),t.body.appendChild(n),e.ADTECH=e.ADTECH||{},i.appendScript(c,function(){e.ADTECH.loadAd&&e.ADTECH.loadAd({protocol:e.location.protocol.split(":")[0],server:"adserver.adtech.de",network:"82.0",placement:a})})}function r(){a&&o()}var a=n.getInteger("partner.adbar.cuid",!1),c="//aka-cdn-ns.adtech.de/dt/common/DACLoader.js";return r};var i=i||{};i.AdBar=function(e,n,i,o,a,c,s){function d(){}var u=1,l="adbar",p=480,h=270,f=i.getInteger("partner.adbar.width",p),g=i.getInteger("partner.adbar.height",h),v=i.get("partner.adbar.position",!1),m="standard";return d.prototype=new a.Observable,d.prototype.invoke=function(a){function d(e){var t=o.waterfall.select(e,"adbar",m);return m=t.decoration,t.creative}function p(e,t){var i={bottom:0},o=e.template.params,r=e.getAd(),a=r.creative.diyValues||{};v&&!o.scaleToWidth&&(i[v]=10),e.position=new n.position.Fixed(i,{animate:!0,controlledOpen:!!a.controlledOpen}),t(null,e)}function h(e,t,i){function o(){c.adImpression({product:e.product,hookId:e.settings.vibrantParameters.hookId,setId:e.settings.vibrantParameters.setId,source:t})}var r=e.getAd(),a=r.creative.diyValues||{};e=n.decoration.decorate(e,{decorationType:m}),a.controlledOpen?e.on(e.CONTROLLED_OPEN,o):o(),i()}function y(e,t,n){c.adClose({product:e.product,hookId:e.settings.vibrantParameters.hookId,source:t||r.Log.closeSource.AUTO}),n()}var b=t.body.clientWidth,w=b>=f?f:b;e.request(l,{ids:[u+":"+w+":"+g],count:1},function(e){var t,o;e.hasOwnProperty(u)&&(o=e[u][0],o.container={width:b},t=n.adunit.create({product:l,settings:o,templateSettings:{cdnUrl:"//"+i.cdn.internal,id:o.ads[0].creative.value},creativeLoad:d,render:p,open:h,close:y}),c.hookLoad({product:l,hookIds:o.vibrantParameters.hookId}),s.track(t,o.trackers,o.term),t.connect("opened",t,"impression"),t.connect(t.EVENT_CLICK,t,"click"),t.fire("open",a.viewSource))})},d};var i=i||{};i.AdhesionBackfill=function(e,t,n,i,o){function r(e){n.Observable.call(this),this.fetchFormat=e.fetchFormat}var a=1,c=o.getBoolean("partner.adhesion.refresh",!0),s=o.getInteger("partner.adhesion.refreshtime",3e4),d=1500,u=!0;return r.prototype=new n.Observable,r.prototype.invoke=function(t){function n(){u=!1}var o=this;u&&(e.request("adhesion",{ids:[i.replaceUrlParams(o.fetchFormat,{id:a})],count:1},function(e){e.hasOwnProperty(a)&&o.fire("adsReady",{ads:e[a][0],product:"adhesion",viewSource:t.viewSource,disableAdCallback:n,refresh:{enabled:c,interval:s,delay:d}})}),t.forceFlush&&e.forceFlush())},r};var i=i||{};i.AdhesionPlacement=function(t,n,i,o,a,c,s,d){function u(){a.Observable.call(this);var e=this;this.isUserTouchingTheScreen=!1;var t=d.debounce(function(t){l&&!e.isUserTouchingTheScreen&&l.fire(v,t&&t.data||{})},p,{leading:!1});this.on(r.app.trigger.resize,t),this.on(r.app.trigger.zoom,t),this.on(r.app.trigger.scroll,t),this.on(r.app.trigger.touchend,function(n){e.isUserTouchingTheScreen=!1,setTimeout(function(){t(n)},p)}),this.on(r.app.trigger.touchstart,function(t){e.isUserTouchingTheScreen=!0,l&&!l.outerBox.contains(t.data.target)&&setTimeout(function(){l.fire(m)},h)})}var l,p=250,h=80,f=!0,g="standard",v="redraw",m="hide";return u.prototype=new a.Observable,u.prototype.invoke=function(d){function u(t,n,i){n===r.Log.closeSource.AD&&(f=!1,d.disableAdCallback&&d.disableAdCallback()),n===r.Log.closeSource.FORCE&&d.disableAdCallback&&d.disableAdCallback(),c.adClose({product:k,hookId:t.settings.vibrantParameters.hookId,source:n||r.Log.closeSource.AUTO}),O.enabled&&n===r.Log.closeSource.AUTO&&e.setTimeout(function(){C.fire("fetchAd",{viewSource:d.viewSource,forceFlush:!0})},O.delay),i()}function p(e,n){e.position=new t.position.Fixed({bottom:0,left:0},{animate:!0}),n(null,e)}function h(n,i,r){if(f){n=t.decoration.decorate(n,{decorationType:g});var s=n.outerBox,d=s.querySelector(".vm-adunit-content"),u=s.querySelector(".vm-adunit-body");a.bindConnect(d,"click",w,w.EVENT_CLICK),d.style.backgroundColor="rgba(0, 0, 0, 0.3)",d.style.width=e.innerWidth+"px",u.style.margin="auto",n.on(m,function(){s.style.display="none",s.style.visibility="hidden"}),n.on(v,function(){var t=o.getWinWidth(),i=o.getWinHeight(),r=e.screen&&e.screen.availHeight||i,a=o.getScrollX(),c=o.getScrollY(),l=o.getStyle(s),p=parseFloat(l.height).toFixed(1),h=e.outerWidth/e.innerWidth,f={width:t,height:p};return h>1.45?void n.fire(m):(h<1.1?(s.style.position="fixed",s.style.top="auto",s.style.left="0px",s.style.bottom="0px",s.style.transform="",d.style.width=e.innerWidth+"px"):(s.style.position="absolute",s.style.left=a+"px",s.style.bottom="auto",s.style.transform=["scaleY(",parseFloat(Math.pow(i,1.1)/(1.1*r)).toFixed(3),")"].join(""),s.style.top=[8+i+c-1.3*f.height,"px"].join(""),d.style.width=f.width+"px"),s.style.width=f.width+"px",s.style.height=f.height+"px",s.style.display="block",s.style.visibility="visible",void(u.style.margin="auto"))})}c.adImpression({product:k,hookId:n.settings.vibrantParameters.hookId,setId:n.settings.vibrantParameters.setId,source:i}),r(),O.enabled&&e.setTimeout(function(){n.fire("close")},O.interval)}var y,b,w,k,E,O,C=this;return d.hook?(b=d.hook,y=b.getAdConfig(),E=y.ads[0].creative.value):d.ads&&(y=d.ads,E=y.ads[0].creative.value),k=d.product||"intext",O=d.refresh||{},l&&"adhesion"!==l.product&&"adhesion"===k?void d.disableAdCallback():(w=t.adunit.create({product:k,settings:y,templateSettings:{cdnUrl:"//"+n.cdn.internal,id:E},creativeLoad:function(e){var t=i.waterfall.select(e,"adhesion",g);return g=t.decoration,t.creative},render:p,open:h,close:u}),c.hookLoad({product:k,hookIds:y.vibrantParameters.hookId}),l&&"adhesion"===l.product&&"adhesion"!==k?l.fire("close",r.Log.closeSource.FORCE):l&&l.fire("close",r.Log.closeSource.AUTO),s.track(w,y.trackers,y.term),w.connect("opened",w,"impression"),w.connect(w.EVENT_CLICK,w,"click"),d.triggerSource&&w.once("opened",function(){w.fire("delegate",{triggerSource:d.triggerSource,source:r.Log.clickSource.HOOK})}),w.fire("open",d.viewSource),void(l=w))},u};var i=i||{};i.AutoReveal=function(e,t,n,i){function o(){var e,t=n.get(h);return t?(t=t.split(","),e=parseInt(t[0],10),e>=g&&+new Date-parseInt(t[1],10)<1e3*v?-1:e):0}function a(e){var t=e.getAdConfig().ads[0].creative,n=parseInt((t.diyValues||{}).autoreveal,10),i=b.test(t.creativeType)?0!==n:1===n;return e.isInViewport()&&!e.autoOpened&&i}function c(e,t){var i,r=t.hooks||[],c=t.viewSource;if(d&&!(y>=f)&&r.length&&(i=o(),!(i<0)))for(var s=0;s<r.length;s++){var u=r[s];if(a(u)){e.invoke({hook:u,viewSource:c}),u.autoOpened=!0,y++,n.set(h,[++i,+new Date].join(","),v);break}}}function s(){return d&&y<f}var d,u=1,l=2,p=180,h="VM_AUTOREVEAL",f=e.getInteger("global.autoreveal.maxpersession",u),g=e.getInteger("global.autoreveal.maxpertimeframe",l),v=e.getInteger("global.autoreveal.timeframe",p),m=e.get("mobile",!1),y=0,b={0:new RegExp(/^()/),1:new RegExp(/^internal/),2:new RegExp(/^(?!internal)/)}[2];switch(e.getInteger("partner.autoreveal",0)){case 1:d=!0;break;case 2:d=!m;break;case 3:d=m;break;default:d=!1}return i.on(r.app.trigger.load,function(){y=0}),{autoOpen:c,revealsAllowed:s,parseCookie:o,testOpenConditions:a}};var i=i||{};i.Daw=function(t,n,i,o,a,c,s){function d(){}var u=1,l=e.innerWidth/2<300?300:Math.round(e.innerWidth/2),p=e.innerHeight,h=i.getInteger("partner.daw.width",l),f=i.getInteger("partner.daw.height",p),g=i.getBoolean("partner.daw.refresh",!0),v=i.getInteger("partner.daw.refreshtime",3e4),m=1500;return d.prototype=new a.Observable,d.prototype.invoke=function(a){function d(){t.request("daw",{ids:[u+":"+h+":"+f],count:1},function(e){var t,r;e.hasOwnProperty(u)&&(r=e[u][0],t=n.adunit.create({product:"daw",settings:r,templateSettings:{cdnUrl:"//"+i.cdn.internal,id:r.ads[0].creative.value},creativeLoad:function(e){var t=o.waterfall.select(e,"daw",b);return b=t.decoration,t.creative},render:p,open:y,close:l}),c.hookLoad({product:"daw",hookIds:r.vibrantParameters.hookId}),s.track(t,r.trackers,r.term),t.connect("opened",t,"impression"),t.connect(t.EVENT_CLICK,t,"click"),t.fire("open",a.viewSource))})}function l(n,i,o){c.adClose({product:n.product,hookId:n.settings.vibrantParameters.hookId,source:i||r.Log.closeSource.AUTO}),g&&i===r.Log.closeSource.AUTO&&e.setTimeout(function(){d(),t.forceFlush()},m),o()}function p(e,t){e.position=new n.position.Fixed({bottom:0,right:10},{animate:!0}),t(null,e)}function y(t,i,o){t=n.decoration.decorate(t,{decorationType:b}),c.adImpression({product:t.product,hookId:t.settings.vibrantParameters.hookId,setId:t.settings.vibrantParameters.setId,source:i}),o(),g&&e.setTimeout(function(){t.fire("close")},v)}var b=i.get("partner.decorationtype","chrome");d()},d};var i=i||{};i.DropInPlacement=function(e,t,n,i,o,a){function c(){}var s="dropin";return c.prototype=new i.Observable,c.prototype.invoke=function(i){function c(e,t,n){t===r.Log.closeSource.AD&&i.disableAdCallback&&i.disableAdCallback(),o.adClose({product:e.product,hookId:e.settings.vibrantParameters.hookId,source:t||r.Log.closeSource.AUTO}),n()}function d(t,n){t.position=new e.position.Fixed({bottom:0},{animate:!1}),n(null,t)}function u(t,n,i){t=e.decoration.decorate(t,{decorationType:s}),o.adImpression({product:t.product,hookId:t.settings.vibrantParameters.hookId,setId:t.settings.vibrantParameters.setId,source:n}),i()}var l=i.hook,p=l.getAdConfig(),h=l.getProduct(),f=e.adunit.create({product:h,settings:p,templateSettings:{cdnUrl:"//"+t.cdn.internal,id:p.ads[0].creative.value},creativeLoad:function(e){var t=n.waterfall.select(e,"dropin",s);return s=t.decoration,t.creative},render:d,open:u,close:c});o.hookLoad({product:f.product,hookIds:p.vibrantParameters.hookId}),a.track(f,p.trackers,p.term),f.connect("opened",f,"impression"),f.connect(f.EVENT_CLICK,f,"click"),i.triggerSource&&f.once("opened",function(){f.fire("delegate",{triggerSource:i.triggerSource,source:r.Log.clickSource.HOOK})}),f.fire("open",i.viewSource)},c};var i=i||{};i.Inline=function(e,t,n,i,o,a,c,s){function d(){this.adConfig=n.get("partner.inline",{})}var u=480,l=360;return d.prototype=new o.Observable,d.prototype.invoke=function(o){function d(e,t,n){a.adClose({product:e.product,hookId:e.settings.vibrantParameters.hookId,source:t||r.Log.closeSource.AUTO}),n()}function p(e,n){e.position=new t.position.Inline(f.getDomNode()),n(null,e)}function h(e,n,i){e=t.decoration.decorate(e,{decorationType:v}),a.adImpression({product:e.product,hookId:e.settings.vibrantParameters.hookId,setId:e.settings.vibrantParameters.setId,source:n}),i()}var f=o.hook,g=f.getId()+":"+this.adConfig.get("adwidth",u)+":"+this.adConfig.get("adheight",l),v="standard";e.request("inline",{ids:[g],count:1},function(e){var r,u,l=f.getId();e[l]?(r=e[l][0],u=t.adunit.create({product:"inline",settings:r,templateSettings:{cdnUrl:"//"+n.cdn.internal,id:r.ads[0].creative.value},creativeLoad:function(e){var t=i.waterfall.select(e,"inline",v);return v=t.decoration,t.creative},render:p,open:h,close:d}),a.hookLoad({product:"inline",hookIds:r.vibrantParameters.hookId}),c.track(u,r.trackers,r.term),u.connect("opened",u,"impression"),u.connect(u.EVENT_CLICK,u,"click"),u.fire("open",o.viewSource)):s.notifyFailure("inline")})},d};var i=i||{};i.ScriptsLoader=function(e,n){function i(e){o&&s(e.hooks)}for(var o,r=e.getJSON("scripts",[]),a=t.head||t.getElementsByTagName("head")[0],c=0;c<r.length;c++)if("captify"===r[c].source){o=r[c].pixel;break}var s=n.once(function(e){var n=(e||[]).map(function(e){return e.getAdConfig().term.keyword}).join(" "),i=t.createElement("script");i.type="text/javascript",i.async=!0,i.text=o.replace("${KEYWORDS}",n),a.appendChild(i)});return{invoke:i}};var i=i||{};i.Tooltip=function(e,t,n,i,o,a,c,s,u,l){function p(){var e=this;a.Observable.call(this),l.on(r.app.inview.animationStart,function(){e.closeOpenTooltips()})}function h(l,p,h){function y(t,n,i){var o;p.disconnectAll(I),delete O[p.getId()];var d=s.once(function(){o&&o(),c.adClose({product:t.product,hookId:t.settings.vibrantParameters.hookId,source:n||r.Log.closeSource.AUTO}),i()});s.isIE?e.setTimeout(d,g):o=a.bind(t.outerBox,"transitionend",d)}function b(e,n){var i,r=e.getAd().hook||{};e.position=new t.position.Absolute(function(){return f(I.getPosition(),p.getPosition(),r)}),i=o.onPositionChange(p.getDomNode(),function(){e.fire("domChange")},v),e.on("close",i),n(null,e)}function w(e,n,i){e=t.decoration.decorate(e,{decorationType:C}),c.adImpression({product:e.product,hookId:e.settings.vibrantParameters.hookId,setId:e.settings.vibrantParameters.setId,source:n}),i()}var C=k,I=t.adunit.create({product:"intext",settings:l,openDelay:m.getInteger("opendelay",null),closeDelay:m.getInteger("closedelay",null),templateSettings:{cdnUrl:"//"+n.cdn.internal,id:l.ads[0].creative.value},creativeLoad:function(e){var t=i.waterfall.select(e,"tooltip",C);return C=t.decoration,t.creative},render:b,open:w,close:y});return u.track(I,l.trackers,l.term),I.connect("opened",I,"impression"),I.connect(I.EVENT_CLICK,I,"click"),p.connect(d.Hook.EVENT_HOOKIN,I,I.EVENT_MOUSEIN),p.connect(d.Hook.EVENT_HOOKOUT,I,I.EVENT_MOUSEOUT),p.connect(d.Hook.EVENT_CLICK,I,I.EVENT_CLICK),
h.triggerSource&&I.once("opened",function(){I.fire("delegate",{triggerSource:h.triggerSource,viewSource:h.viewSource,source:r.Log.clickSource.HOOK})}),I.on(I.EVENT_MOUSEOUT,function(){I.fire("scheduleClose",r.Log.closeSource.AUTO)}),I.on(I.EVENT_MOUSEIN,function(){I.cancelScheduledClose()}),p.on(d.Hook.EVENT_HOOKOUT,function(){I.isOpen()&&I.fire("scheduleClose",r.Log.closeSource.AUTO)}),E.push(I),O[p.getId()]=I,I}function f(e,t,n){var i,r,a,c=o.getAbsoluteViewport(),d=n.coverhook||y,u=[],l=0;for(var p in C)if(C.hasOwnProperty(p)){if(i=C[p](e,t,d),c.contains(i))return i;u.push(i)}return s.forEach(u,function(e){var t=c.getIntersection(e);t&&t.pixels()>l&&(l=t.pixels(),r=e,a=t)}),r?(r.shiftY(a.top-r.top||a.bottom-r.bottom),r.shiftX(a.left-r.left||a.right-r.right),r):t.top>c.bottom?u[0]:u[1]}var g=300,v=100,m=n.get("partner.intext",{}),y=m.get("coverhook",!1),b=7,w=11,k=n.get("partner.decorationtype","chrome"),E=[],O={},C={placeAboveHook:function(e,t,n){var i=e.clone();switch(i.setCenter(t.getCenter()),n){case"cover":case"1":i.shiftY(-(e.getHeight()-t.getHeight())/2-b);break;case"center":case"centre":break;default:i.shiftY(-(e.getHeight()+t.getHeight())/2)}return i},placeBelowHook:function(e,t,n){var i=e.clone();switch(i.setCenter(t.getCenter()),n){case"cover":case"1":i.shiftY((e.getHeight()-t.getHeight())/2+w);break;case"center":case"centre":break;default:i.shiftY((e.getHeight()+t.getHeight())/2)}return i}};return p.prototype=new a.Observable,p.isAnyOpen=function(){return s.some(E,function(e){return e.isOpen()})},p.prototype.closeOpenTooltips=function(){l.fire(r.app.intext.tooltipClose),s.forEach(E,function(e){e.isOpen()&&e.fire("close",r.Log.closeSource.AUTO)})},p.prototype.invoke=function(e){var t,n=e.hook,i=n.getAdConfig();n===this.activeHook&&this.activeUnit.isOpen()||(t=O[n.getId()]||h(i,n,e),t.isOpen()?t.cancelScheduledClose():(this.closeOpenTooltips(),t.fire("open",e.viewSource||r.Log.viewSource.MOUSE_OVER)))},p};var i=i||{};i.VibrantView=function(e,t,n,i){function o(){return n.Observable.call(this),this.hookBucket=[],this.openedHooks={},this.views=0,this._allowOnLoad=v,this._allowOnScroll=m,this._hasLoaded=!1,this._lastTiggeredHook=null,this._isBlocked=!1,f&&g&&(v||m)?void this.on("scroll",function(e){var t=!(0===e.data.direction&&this._allowOnLoad),n=!(e.data.direction>0&&this._allowOnScroll);if(!t||!n)return this.views>=y?void this.fire("maxViewsReached"):void(this._lastTiggeredHook&&this._lastTiggeredHook.isInViewport()||a(this,e.data.viewSource))},this):void(this._isBlocked=!0)}function a(){}function c(e){var n,i;return 0!==e&&(!!(n=parseInt(t.get(l),10))&&(i=+new Date-n,i<e*s))}var s=6e4,d=5,u=1,l="VM_VVTIME",p=e.get("geo"),h=e.get("partner.vibrantview",{}),f=!i.includes(h.getArray("geoblock",[]),p.cc),g=!c(h.getInteger("minutes",d)),v=h.getBoolean("onload",e.getBoolean("mobile",!1)),m=h.getBoolean("onscroll",e.getBoolean("mobile",!1)),y=h.get("maxviews",u);return o.prototype=new n.Observable,o.prototype.invoke=function(e){return!!this._isBlocked||(this.hookBucket=this.hookBucket.concat(e.hooks),this._allowOnLoad&&!this._hasLoaded&&a(this,r.Log.viewSource.LOAD),void(this._hasLoaded=!0))},o.prototype.maxViews=y,o};var i=i||{};i.Wordflip=function(e,t,n,i,o,a,c,s){function u(){var e=this;a.Observable.call(this),this.partnerControl=n.getBoolean("partner.intext.wordflip",!!n.mobile),this.triggerFlip=function(){return e.partnerControl?function(e){e._wordflip.flip()}:function(t){e.fire(t.getProduct()+":"+p.HIGHLIGHT,{hook:t,viewSource:r.Log.viewSource.MOUSE_OVER})}}(),this.hookBucket=[],this.firstFlipped=!1,this.on("doflip",function(){i.some(e.hookBucket,function(t){if(t.isInViewportArea(E)&&!t.triggered&&!t._wordflip.flipped&&!O)return e.triggerFlip(t),!0})}),this.connect("scroll",this,"doflip"),this.on("resize",function(){i.forEach(e.hookBucket,function(e){e._wordflip.positionWordflip()})}),s.on(r.app.inview.animationStart,function(){O&&O._wordflip.closeFlip()})}function l(e,t){this.hook=e,this.channel=t,this.boxWidth=0,this.textNode=this.hook.getDomNode().firstChild,this.hookStyling=this.hook.adConfig.ads[0].hook||{},this.wordflipSetup(),this.hookStyling.text||this.hookStyling.icon?(this.hookText(),this.hookIcon()):this.defaultStyle(),this.positionWordflip(),this.flipEvents()}var p={HIGHLIGHT:"highlight"},h="vm-wordflip",f=" vm-wordflip-default",g=" vm-wordflip-styled",v=2,m=20,y="-1000px",b=1800,w=250,k=550,E=.75,O=!1;return u.prototype=new a.Observable,u.prototype.invoke=function(e){function t(e,t,i){return function(){n.fire(t,{hook:e,viewSource:i,triggerSource:t})}}var n=this;this.hooks=e.hook&&[e.hook]||e.hooks||c.getVisibleHooks(),this.hooks.length&&(i.forEach(this.hooks,function(e){e.eventsBound||(e.eventsBound=!0,e._wordflip=new l(e,n),n.hookBucket.push(e),e.on(d.Hook.EVENT_CLICK,function(){t(e,"click",r.Log.viewSource.MOUSE_OVER)}),e.on(d.Hook.EVENT_HOOKIN,function(){t(e,"hover",r.Log.viewSource.MOUSE_OVER),n.triggerFlip(e)}),e.on(d.Hook.EVENT_HOOKOUT,t(e,"mouseleave",r.Log.viewSource.MOUSE_OVER)),o.onPositionChange(e.getDomNode(),function(){e._wordflip.positionWordflip()},w))}),n.fire("doflip"))},l.prototype.flip=function(){if(O&&this.hook!==O)O._wordflip.closeFlip();else if(this.hook===O)return;O=this.hook,this.openFlip(),this.channel.fire(this.hook.getProduct()+":"+p.HIGHLIGHT,{hook:this.hook,viewSource:r.Log.viewSource.MOUSE_OVER}),this.flipped=!0},l.prototype.openFlip=function(){var t=this;this.box.style.visibility="visible",this.box.style.opacity=1,i.isIE&&(this.box.style.filter="alpha(opacity = 100)"),this.closeDelay=e.setTimeout(function(){t.closeFlip()},b)},l.prototype.closeFlip=function(){var t,n;this.closeDelay&&e.clearTimeout(this.closeDelay),t=i.once(function(){n&&n(),O=!1}),i.isIE?(e.setTimeout(t,k),this.box.style.filter="alpha(opacity = 0)"):(n=a.bind(this.box,"transitionend",t),e.setTimeout(t,k)),this.box.style.opacity=0},l.prototype.wordflipSetup=function(){this.box=t.createElement("div"),this.box.className=h,this.box.style.position="absolute",this.box.style.top=y,this.box.style.left=y,this.box.style.visibility="hidden",this.box.style.opacity=0,this.box.style.height=this.textNode.offsetHeight+v+"px"},l.prototype.positionWordflip=function(){this.box.style.width=this.boxWidth+"px",t.body.appendChild(this.box),this.hookCenter=o.getPosition(this.textNode).getCenter(),this.boxPos=o.getPosition(this.box),this.boxPos.setCenter(this.hookCenter),o.setPosition(this.box,this.boxPos)},l.prototype.hookIcon=function(){this.hookStyling.icon&&(this.icon=t.createElement("img"),this.icon.src=this.hookStyling.icon,this.box.appendChild(this.icon),this.boxWidth+=m+2*v)},l.prototype.hookText=function(){var e=this.hookStyling.text||this.hook.adConfig.term.keyword;this.textBox=t.createElement("span"),o.setTextContent(this.textBox,e),this.box.appendChild(this.textBox),this.box.className+=g,this.boxWidth=o.getTextDimensions(e).getWidth()+v},l.prototype.defaultStyle=function(){this.box.className+=f,this.boxWidth=this.textNode.offsetWidth+2*v},l.prototype.flipEvents=function(){a.bindConnect(this.box,"click",this.hook,d.Hook.EVENT_CLICK),n.mobile||(a.bindConnect(this.box,"mouseenter",this.hook,d.Hook.EVENT_HOOKIN),a.bindConnect(this.box,"mouseleave",this.hook,d.Hook.EVENT_HOOKOUT))},u};var o=o||{};o.Loader=function(e,t,n,i,o,a,c,s){function d(e,t){a.headerBid({bidder:e,success:t?r.Log.headerBid.SUCCESS:r.Log.headerBid.FAILURE})}function u(){i.forOwn(c,function(t,n){function r(){e.clearTimeout(u),e.clearInterval(c)}function a(){d(n,f.success),f.success&&s.register(n,f)}var c,u,f;i.includes(l,t.adProvider)||(o.appendTextScript(t.script),c=e.setInterval(function(){f=t.callback(e),f.success&&(r(),a())},h),u=e.setTimeout(function(){r(),a()},p))})}var l=n.getArray("partner.exAdProviders",[]),p=1e3,h=10;return u};var o=o||{};o.Mediator=function(e,t){function n(e,t){d[e]||(d[e]=t)}function i(e){delete d[e]}function o(t,n){d[t]&&(d[t].products=e.filter(d[t].products,function(e){return e!==n}))}function a(e){d[e]&&d[e].hasOwnProperty("impressionCap")&&(--d[e].impressionCap,d[e].impressionCap<=0&&i(e))}function c(){var t={};return e.keys(d).length?(e.forOwn(d,function(n,i){n.products&&e.isArray(n.products)&&e.forEach(n.products,function(e){t[e]||(t[e]=[]),t[e].push(l(i,e,n))})}),t):t}function s(){return d}var d={},u={daw:!0},l=function(){var e={};return function(t,n,i){var o,r;return e[t]&&e[t][n]?e[t][n]:(e[t]||(e[t]={}),o=i.params||{},r="",r+=o[n]?t+"-"+encodeURIComponent(JSON.stringify(o[n])):t,e[t][n]=r,r)}}();return t.on(r.app.bid.impression,function(e){var t=e.data.product,n=e.data.bidder;u[t]&&o(n,t),a(n)}),{register:n,getBiddersByProduct:c,removeBidder:i,removeBidderProduct:o,bidImpression:a,getActiveBidders:s,formatBidder:l}};var r=r||{};r.AdFetcher=function(e,t,n,i){function o(e,t,n){u[e]=t,l[e]=n}function a(e,n){t.fire(r.app.ads.newAds,{product:e,ads:n})}function c(t){if(!n.isEmpty(u)){t=t||{};var i=l;e.getAds(u,t,function(e){n.forOwn(i,function(t,n){a(n,e[n]),i[n](e[n])})}),u={},l={}}}function s(){c({contextKey:d})}var d=i.get("articleHash",i.get("urlHash")),u={},l={};return t.on(r.app.context.key,function(e){d=e.data.contextKey}),{request:o,flush:c,forceFlush:s}};var r=r||{};r.AdsMonitor=function(e){function t(e){return"image"===e?n(e):s[e]||[]}function n(e){var t=d[e];return t?[t]:[]}function i(){return a||[]}var o={},a=[],c={},s={},d={};return e.on(r.app.ads.newAds,function(e){var t,n,i,r,u=e.data,l=u.product,p=u.ads;for(n in p)p.hasOwnProperty(n)&&p[n][0]&&p[n][0].vibrantParameters&&(i=p[n][0],t=i.vibrantParameters.keywordId,r=i.vibrantParameters.setId,t&&!o[t]&&(o[t]=1,a.push(t)),c[l]=c[l]||{},s[l]=s[l]||[],d[l]=r,r&&!c[l][r]&&(c[l][r]=1,s[l].push(r)))}),{getUsedSets:t,getUsedKeywords:i,getLastUsedSet:n}};var r=r||{};r.Api=function(e,t,n,i,o,r,a,c,s){function d(t,i,r){function a(){r(JSON.parse(d.responseText))}function c(){r({success:!1,errors:["There was an error sending the request"]})}function s(){r({success:!1,errors:["Request timed out"]})}var d=new XMLHttpRequest,u="//"+n.apiHost+t;"withCredentials"in d?(o.bind(d,"load",a),o.bind(d,"error",c),o.bind(d,"timeout",s),d.open("POST",u,!0),d.setRequestHeader("Content-Type","application/json"),d.withCredentials=!0,d.send(JSON.stringify(i))):e.XDomainRequest?(d=new XDomainRequest,d.onprogress=function(){},d.onload=a,d.onerror=c,d.ontimeout=s,d.open("POST",u),setTimeout(function(){d.send(JSON.stringify(i))},0)):r({success:!1,errors:["Browser does not support CORS requests"]})}function u(t,o,a){var c="vib_"+f++,s="//"+n.apiHost+t+"?callback="+c+"&"+r.toQueryString(o);e[c]=function(){a.apply(this,arguments);try{delete e[c]}catch(t){e[c]=void 0}},i.appendScript(s)}function l(e,i,o){var a=r.extend({ipid:n.ipid,pvu:n.pvu,urlHash:n.urlHash,nodes:r.map(e,function(e){return{id:e.getId(),text:e.getTextContent()}})},i);d("/context/"+t.context,a,function(e){e&&e.success&&o(e)})}function p(e){i.dropImage("//"+n.apiHost+"/context/"+t.context+"?"+r.toQueryString({ipid:n.ipid,contextKey:e,pvu:n.pvu}))}function h(e,i,o){var a=s.getBiddersByProduct(),d=r.extend({ipid:n.ipid,pvu:n.pvu,kw:c.getUsedKeywords().join(",")},i);r.forOwn(e,function(e,t){r.forOwn(e,function(e,n){d[t+"."+n]=e,d[t+".sets"]=g?c.getUsedSets(t).join(","):"",d[t+".bidders"]=a[t]?a[t].join("|"):""})}),u("/ad/"+t.ad,d,function(e){e&&e.success&&o(e)})}var f=1,g=n.getBoolean("partner.norepetitive",!1);return{contextualise:l,logContext:p,getAds:h}};var r=r||{};r.AppChannel=function(e){return r.app={},r.app.main={initialise:"initialise"},r.app.ads={newAds:"newAds"},r.app.context={key:"contextKey"},r.app.trigger={newContent:"newContent",load:"load",scroll:"scroll",resize:"resize",zoom:"zoom",touchstart:"touchstart",touchend:"touchend"},r.app.intext={tooltipClose:"inText:closeTooltips"},r.app.inview={animationStart:"inView:AnimationStart",animationEnd:"inView:AnimationEnd"},r.app.inline={animationStart:"inline:AnimationStart",animationEnd:"inline:AnimationEnd"},r.app.bid={impression:"headerBidding:Impression"},new e.Observable};var r=r||{};r.Config=function(e,t,n){var i={},o={};return i.get=function(e,n){var o=this;return t.some(e.split("."),function(t){if(!o.hasOwnProperty(t)){if("undefined"!=typeof n)return o=n,!0;throw new Error('Config item "'+e+'" not found')}o=o[t]}),t.isObject(o)&&t.extend(o,i),o},i.getArray=function(e,t){var n=this.get(e,t);return"string"==typeof n?n.split(","):n},i.getBoolean=function(e,t){var n=this.get(e,t);return"string"==typeof n?"1"===n:n},i.getInteger=function(e,t){var n=this.get(e,t);return"string"==typeof n?parseInt(n,10):n},i.getJSON=function(e,t){var n=this.get(e,t);return"string"==typeof n?JSON.parse(n):n},o.execute=function(e,n){t.forEach(n,function(t){t(e)})},e=t.extend(e,i),t.forEach(n,function(t){var n=[e].concat(t.args);o[t.type].apply(this,n)}),e};var r=r||{};r.ContentMonitor=function(e,n,i,o,a,c,s,d){function u(e,t){var a={primary:e.primary};a.primary&&n.get("articleHash",!1)?a.articleHash=n.get("articleHash"):e.hasOwnProperty("articleId")&&(a.articleId=e.articleId);var u=s.findTextNodes(e.textNodes),p=h?d.filter(o.findImages(e.imageNodes),function(e){return!i.parentHasSelector(e.image,h)}):o.findImages(e.imageNodes);u.length&&(f[e.articleId]=!0,c.contextualise(u,a,function(e){l.fire(r.app.main.initialise,{pubXReached:e.pubXReached}),l.fire(r.app.trigger.newContent,{textNodes:u,images:p}),e.articleHash&&l.fire(r.app.context.key,{contextKey:e.articleHash}),t(e.articleHash)}))}var l,p=n.getBoolean("mobile",!1)?"mobile":"desktop",h=n.getArray("partner.gallery.selectors",!1),f={},g=!0,v={};return v.dynamicStrategy=function(e,t){function n(){var n=d.debounce(function(){t(),i.onViewportChange(n)},e.interval);i.onViewportChange(n)}function o(){d.poll(function(){return!0},t,e.interval)}function r(){}var a={debounce:n,polling:o,click:r};a[e.type](),t()},v.parseNewContent=function(t,i,o){var a=o.innerText||t.getAttribute(o);f.hasOwnProperty(a)||(u({textNodes:t.childNodes,imageNodes:t.childNodes,articleId:a,primary:g},function(t){i.contextKey=t||n.get("articleHash",n.get("urlHash")),l.fire(r.app.trigger.load),e.flush(i)}),g=!1)},v.standardPage=function(){var t={};u({textNodes:n.get("partner.intext.selectors"),imageNodes:n.get("partner.image.selectors"),primary:!0},function(){t.contextKey=n.get("urlHash"),l.fire(r.app.trigger.load),e.flush(t),i.onViewportChange(function o(){l.fire(r.app.trigger.scroll),e.flush(t),i.onViewportChange(o)})})},v.run=function(i){var o={},a={type:"debounce",interval:200},c=n.getJSON("partner.dynamic",{});l=i,c.get("selector",!1)?(n.get("partner.intext",!1)&&(n.partner.intext.selectors=c.get("selector.css")),v.dynamicStrategy(c.getJSON("strategy."+p,a),function(){var n=c.get("selector.identifier",!1);l.fire(r.app.trigger.scroll),d.forEach(t.querySelectorAll(c.get("selector.css")),function(e){var i=n?t.querySelector(n):c.get("selector.property","id");v.parseNewContent(e,o,i)}),e.flush(o)})):v.standardPage()},v};var r=r||{};r.CookieSync=function(t,n,i,o,r){function a(){"undefined"!=typeof n.userId&&o.forOwn(n.syncDetails,function(e,t){var a=o.replaceUrlParams(u,{provider:t}),c=d&&e.secureUrl?e.secureUrl:e.url;a+=e.userIdPlaceholder;var s=o.replaceUrlParams(c,{userId:n.userId,redirect:a});switch(e.type){case"image":i.dropImage(s);break;case"iframe":i.appendIFrame(s);break;default:throw r.auditError({message:"[CookieSync] Unknown cookie sync type for "+t+": "+e.type})}})}var c=/\:(\w+)/g,s=e.location.protocol,d=s.indexOf("s")>-1;n.syncDetails&&o.forOwn(n.syncDetails,function(e){e.url=e.url.replace(c,"{{$1}}")});var u=s+"//"+n.cookieSyncHost+"/csync/"+t.csync+"/{{provider}}/";return{sync:a}};var r=r||{};r.Cookie=function(e,t){function n(t){return t&&o.test(t)?decodeURIComponent(e.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null}function i(n,i,o){t.dnt||(e.cookie=n+"="+encodeURIComponent(i)+";path=/"+(o?";max-age="+o:""))}var o=new RegExp("^"+(t.cookiesNS||"VM_"));return{get:n,set:i}};var r=r||{};r.Debug=function(e,t,n,i,o,r){if(n.debugHost){var a="//"+n.get("cdn.debugjs"),c="//"+n.get("cdn.debugcss");!function(){e.VM.DEBUG=e.VM.DEBUG||{},e.VM.DEBUG.api={config:n,dom:i,events:o,utils:r},i.appendStyleSheet(c),i.appendScript(a)}()}};var r=r||{};r.Dom=function(e,t,n,i){function o(){return"undefined"!=typeof e.innerWidth?e.innerWidth:t.documentElement.clientWidth}function a(){return"undefined"!=typeof e.innerHeight?e.innerHeight:t.documentElement.clientHeight}function c(){return"undefined"!=typeof e.pageXOffset?e.pageXOffset:t.documentElement.scrollLeft}function s(){return"undefined"!=typeof e.pageYOffset?e.pageYOffset:t.documentElement.scrollTop}function d(t,n){var i=+new Date,o=0;e.setTimeout(function r(){var a,c=+new Date,s=(c-i)/n;a=t>0?Math.min(t,o+s*t):Math.max(t,o+s*t);var d=Math.round(a-o);0!==d&&e.scrollBy(0,d),i=c,o=a,t>0?a<t&&e.setTimeout(r,K):a>t&&e.setTimeout(r,K)},K)}function u(){return new F({top:s(),left:c(),bottom:s()+a(),right:c()+o()})}function l(e,i){var o,r=t.createElement("iframe");return r.frameBorder=0,r.scrolling="no",r.marginWidth=0,r.marginHeight=0,r.hspace=0,r.vspace=0,r.style.position="relative",e.width?(r.width=e.width,r.style.width=e.width+"px"):(r.width="100%",r.style.width="100%"),e.height?(r.height=e.height,r.style.height=e.height+"px"):(r.height="100%",r.style.height="100%"),i&&(o=n.bind(r,"load",function(){o(),i(null,r)})),r}function p(e,i,o){var r=t.createElement("iframe");return r.src=e,r.style.display="none",o=o||t.body,n.bind(r,"load",function(){i&&i(null,r)}),r=o.appendChild(r)}function h(e,i,o){var r=t.createElement("iframe");return r.src=e,r.style.display="none",o=o||t.body,n.bind(r,"load",function(){o.removeChild(r),i&&setTimeout(i)}),r=o.appendChild(r)}function f(e,i,o){var r=t.createElement("script");return r.type="text/javascript",r.async=!0,r.src=e,o=o||M,t.addEventListener?n.bind(r,"load",function(){i&&i()}):r.onreadystatechange=function(){"loaded"!==r.readyState&&"complete"!==r.readyState||(r.onreadystatechange=null,i&&i())},o.appendChild(r),r}function g(e,n){var i=t.createElement("script");return i.type="text/javascript",i.async=!0,i.text=e,n=n||M,n.appendChild(i),i}function v(e,t,n){var i=f(e,function(){t&&t(),n=n||M;try{n.removeChild(i)}catch(e){}},n);return i}function m(e){var n=t.createElement("link");return n.rel="stylesheet",n.type="text/css",n.href=e,M.appendChild(n),n}function y(e){var n=t.createElement("style");return n.type="text/css",V(n,e),M.appendChild(n),n}function b(e,n){var i=t.createElement("img");return i.src=e,k(n)&&(i.style.width="1px !important",i.style.height="1px !important",n.appendChild(i)),i}function w(e,t){t===!0?w.sameWindow(e):w.newWindow(e)}function k(e){return e instanceof HTMLElement&&e.nodeType===r.Dom.ELEMENT_NODE}function E(e){return!!e&&e.constructor===t.createDocumentFragment().constructor}function O(e,n){var i,o=t.createElement("span");return n=n?n:t.body,V(o,e),o.style.position="absolute",o.style.visibility="hidden",o.style.top=z,o.style.left=z,o.style.width="auto",o.style.height="auto",o.style.whiteSpace="nowrap",n.appendChild(o),i=W(o),o.parentNode.removeChild(o),i}function C(e){var t;if(k(e))return t=e.getBoundingClientRect(),new F({top:t.top+s(),right:t.right+c(),bottom:t.bottom+s(),left:t.left+c()})}function I(e,t){var n=["top","left","bottom","right"];i.forEach(n,function(n){t.hasOwnProperty(n)&&(e.style[n]=t[n]+"px")})}function N(e){var t,n;if(k(e))return n=e.getBoundingClientRect(),t={width:n.right-n.left,height:n.bottom-n.top}}function S(e,n){if(!k(e))throw new Error("Not an element");n=n||0;var o=C(e),r=[],a=[[o.left+n,o.top+n],[o.right+n,o.top+n],[o.left+n,o.bottom+n],[o.right+n,o.bottom+n]];return i.forEach(a,function(e){r.push(t.elementFromPoint(e[0],e[1]))}),r}function T(e,t){function n(e){return i.some(t,function(t){return B(e,t)})}var o=!1;if(!k(e))throw new Error("Not an element");for(;e&&"BODY"!==e.tagName;){if(n(e)){o=!0;break}e=e.parentNode}return o}function x(t){return"function"==typeof e.getComputedStyle?e.getComputedStyle(t):t.currentStyle}function L(t){function i(){r(),o=void 0,t()}var o,r;r=n.bind(e,"scroll",function(){o&&e.clearTimeout(o),o=e.setTimeout(i,G)})}function A(e,t,n){function o(){var t=C(e);return!a.equals(t)&&(a=t,!0)}var r,a=C(e);return n=n||X,r=i.poll(o,t,n)}function P(i){function o(){r&&r(),a&&a(),i()}var r,a;"interactive"===t.readyState||"complete"===t.readyState?o():(r=n.bind(e,"load",o),t.addEventListener?a=n.bind(t,"DOMContentLoaded",o):(t.onreadystatechange=function(){"interactive"!==t.readyState&&"complete"!==t.readyState||o()},a=function(){t.onreadystatechange=null}))}function H(e){var t;if(e.nodeType===r.Dom.ELEMENT_NODE)t=C(e);else{if(e.nodeType!==r.Dom.TEXT_NODE)throw new Error("Node type not supported: "+e.nodeType);t=W(e)}return!!t.getIntersection(u())}function D(e,t){function n(e){var t;return e=e.parentNode,null!==e&&e.nodeType===r.Dom.ELEMENT_NODE&&(t=x(e),"hidden"===t.overflow&&parseInt(t.opacity)>0&&!o.getIntersection(C(e))||n(e))}var i,o;return t=t||{},i=x(e),"none"!==i.display&&"hidden"!==i.visibility&&"0"!==i.opacity&&(!t.overflowCheck||(o=C(e),!n(e)))}function U(e){for(var t;e.parentNode;)if(e=e.parentNode,t=e.nodeName.toLowerCase(),"p"===t||"div"===t)return e;return null}function _(e,t){return i.isArray(t)||(t=[t]),i.some(t,function(t){return e.querySelector(t)})}function V(e,t){i.isIE?e.innerText=t:e.textContent=t}function R(e){var t=e.nextElementSibling;if("undefined"==typeof t)for(e=e.nextSibling,t=null;null!==e;){if(e.nodeType===r.Dom.ELEMENT_NODE){t=e;break}e=e.nextSibling}return t}function B(e,n){return e.matches?e.matches(n):i.includes(t.querySelectorAll(n),e)}function F(e){if(!(e&&"object"==typeof e&&i.isFiniteNumber(e.top)&&i.isFiniteNumber(e.left)&&i.isFiniteNumber(e.bottom)&&i.isFiniteNumber(e.right)))throw new Error("Coord: obj is not valid");this.top=e.top,this.left=e.left,this.bottom=e.bottom,this.right=e.right}var W,M=t.head||t.getElementsByTagName("head")[0],G=50,K=10,X=2500,z="-1000px";return w.newWindow=function(t){e.open(t)},w.sameWindow=function(e){t.location.href=e},W=t.createRange&&Range.prototype.getBoundingClientRect?function(e){var n=t.createRange();return n.selectNodeContents(e),new F(n.getBoundingClientRect()).shiftX(c()).shiftY(s())}:function(e){var n=e.parentNode,i=t.createElement("span");n.replaceChild(i,e),i.appendChild(e);var o=i.getBoundingClientRect();return n.replaceChild(e,i),new F(o).shiftX(c()).shiftY(s())},F.prototype.equals=function(e){var t=e instanceof F?e:new F(e);return this.top===t.top&&this.left===t.left&&this.bottom===t.bottom&&this.right===t.right},F.prototype.clone=function(){return new F(this)},F.prototype.getIntersection=function(e){var t,n,i;return t=e instanceof F?e:new F(e),n=this,i=t,n.equals(i)?n.clone():n.bottom<=i.top||n.top>=i.bottom||n.right<=i.left||n.left>=i.right?void 0:new F({top:Math.max(n.top,i.top),left:Math.max(n.left,i.left),bottom:Math.min(n.bottom,i.bottom),right:Math.min(n.right,i.right)})},F.prototype.getCenter=function(){return{x:this.left+(this.right-this.left)/2,y:this.top+(this.bottom-this.top)/2}},F.prototype.setCenter=function(e){var t=this.getCenter();if(e&&"object"==typeof e&&i.isFiniteNumber(e.x)&&i.isFiniteNumber(e.y))return this.top+=e.y-t.y,this.left+=e.x-t.x,this.bottom+=e.y-t.y,this.right+=e.x-t.x,this},F.prototype.pixels=function(){return(this.right-this.left)*(this.bottom-this.top)},F.prototype.shiftX=function(e){if(i.isFiniteNumber(e))return this.left+=e,this.right+=e,this},F.prototype.shiftY=function(e){if(i.isFiniteNumber(e))return this.top+=e,this.bottom+=e,this},F.prototype.contains=function(e){var t=e instanceof F?e:new F(e),n=this.getIntersection(t);return!!n&&n.equals(t)},F.prototype.getWidth=function(){return this.right-this.left},F.prototype.getHeight=function(){return this.bottom-this.top},F.prototype.getArea=function(){return this.getWidth()*this.getHeight()},{appendIFrame:p,appendDisposableIFrame:h,appendScript:f,appendTextScript:g,appendDisposableScript:v,appendStyleSheet:m,appendInlineStyle:y,createIFrame:l,dropImage:b,findParentParagraph:U,elementHasNodes:_,getTextNodeBounds:W,getTextDimensions:O,isElement:k,isDocFragment:E,getPosition:C,setPosition:I,getDimension:N,elementsAtPoints:S,parentHasSelector:T,getStyle:x,getAbsoluteViewport:u,getWinWidth:o,getWinHeight:a,getScrollX:c,getScrollY:s,nextElementSibling:R,matchesSelector:B,onViewportChange:L,onPositionChange:A,openUrl:w,setTextContent:V,smoothScrollY:d,waitForReadyState:P,isInViewport:H,isVisible:D,Coord:F}},r.Dom.ELEMENT_NODE=1,r.Dom.TEXT_NODE=3;var r=r||{};r.Events=function(e){function n(e){e.stopPropagation?e.stopPropagation():(e.cancelBubble=!0,e.returnValue=!1)}function i(){return this[c]={},this.connections=[],this}function o(e){this.data=e||{}}function r(e,t,n,i){return e.connect(t,n,i)}function a(e,t,n,i){return i=i||t,s(e,t,function(e){n.fire(i,e)})}var c="CustomEventsStore__",s=function(){return t.addEventListener?function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}:function(e,t,n){return t="on"+t,e.attachEvent(t,n),function(){e.detachEvent(t,n)}}}();return i.prototype.on=function(e,t,n,i){return this[c][e]||(this[c][e]=[]),i=i||[],this[c][e].push([t,n,i]),this},i.prototype.once=function(e,t,n,i){var o=this,r=!1,a=function(){o.unbind(a),r||(r=!0,t.apply(n,arguments))};return this.on(e,a,n,i)},i.prototype.fire=function(t,n){var i=this[c][t];if(i)return e.forEach(i.slice(),function(e){var t=e[0],i=e[1],r=e[2];t.apply(i,[new o(n)].concat(r))}),this},i.prototype.connect=function(e,t,n){n=n||e;var i=function(e){t.fire(n,e.data)};return this.connections.push({leftEvent:e,rightObservable:t,rightEvent:n,callback:i}),this.on(e,i)},i.prototype.disconnect=function(t,n,i){var o=[];e.forEach(this.connections,function(e,r){t===e.leftEvent&&n===e.rightObservable&&i===e.rightEvent&&(this.unbind(t,e.callback),o.push(r))},this),e.forEach(o,function(e){this.connections.splice(e,1)},this)},i.prototype.disconnectAll=function(t){var n=[];e.forEach(this.connections,function(e,i){t===e.rightObservable&&(this.unbind(e.leftEvent,e.callback),n.push(i))},this),e.forEach(n,function(e){this.connections.splice(e,1)},this)},i.prototype.unbind=function(t,n){var i=this[c][t];i&&e.some(i,function(e,t){if(e[0]===n)return i.splice(t,1),!0})},i.prototype.unbindAll=function(){this[c]={}},{bind:s,bindConnect:a,connect:r,stopPropagation:n,Observable:i,VMEvent:o}};var r=r||{};r.Log=function(e,t,n,i){function o(e,t){return i.replaceUrlParams(a+e,i.extend({},c,t))}function r(e){return function(t){n.dropImage(o(s[e],t))}}var a="//"+t.apiHost+"/log/"+e.log,c={ipid:t.ipid,urlHash:t.urlHash,pvu:t.pvu,postcode:t.geo&&t.geo.pc||""},s={hookLoad:"/hl/{{ipid}}/{{product}}/{{hookIds}}/{{urlHash}}/{{pvu}}",hookFailure:"/hf/{{ipid}}/{{product}}/{{hookId}}/{{reason}}/{{urlHash}}/{{pvu}}",adImpression:"/ai/{{ipid}}/{{product}}/{{hookId}}/{{source}}/{{urlHash}}/{{pvu}}/{{setId}}",clickThrough:"/ck/{{ipid}}/{{product}}/{{hookId}}/{{source}}/{{urlHash}}/{{pvu}}?url={{clickUrl}}",adChoiceClick:"/ac/{{ipid}}/{{product}}/{{hookId}}/{{urlHash}}/{{pvu}}",adClose:"/cl/{{ipid}}/{{product}}/{{hookId}}/{{source}}/{{urlHash}}/{{pvu}}",firstHook:"/mt/tfh/{{timestamp}}/{{ipid}}",auditError:"/adt/{{urlHash}}/{{ipid}}/{{pvu}}/{{timestamp}}/I/{{message}}",pageTracking:"/ptr/{{urlHash}}/{{ipid}}/{{pvu}}/{{referrer}}",videoEvent:"/ve/{{ipid}}/{{product}}/{{hookId}}/{{urlHash}}/{{pvu}}/{{event}}/{{position}}/{{duration}}/{{videoId}}/{{creativeId}}",cpeInteraction:"/cpei/{{ipid}}/{{product}}/{{hookId}}/{{urlHash}}/{{pvu}}/{{event}}/{{element}}/{{creativeId}}",cpeClickThrough:"/cpeck/{{ipid}}/{{product}}/{{hookId}}/{{urlHash}}/{{pvu}}/{{element}}/{{creativeId}}?url={{clickUrl}}",cpeClose:"/cpec/{{ipid}}/{{product}}/{{hookId}}/{{urlHash}}/{{pvu}}/{{dwell}}/{{creativeId}}",engagement:"/eng/{{ipid}}/{{product}}/{{hookId}}/{{source}}/{{urlHash}}/{{pvu}}/{{creativeId}}",progressBar:"/prg/{{ipid}}/{{product}}/{{hookId}}/{{urlHash}}/{{pvu}}/{{event}}/{{creativeId}}",headerBid:"/hdrb/{{ipid}}/{{pvu}}/{{bidder}}/{{success}}"},d=["clickThrough","cpeClickTrhough","auditError"],u={};for(var l in s)s.hasOwnProperty(l)&&!i.includes(d,l)&&(u[l]=r(l));return u.clickThrough=function(e){e.clickUrl=i.replaceUrlParams(e.clickUrl,i.extend({},c,e)),n.openUrl(o(s.clickThrough,e))},u.cpeClickThrough=function(e){e.clickUrl=i.replaceUrlParams(e.clickUrl,i.extend({},c,e)),n.openUrl(o(s.cpeClickThrough,e))},u.auditError=function(e){if(e.message)return e.timestamp=e.timestamp||+new Date,n.dropImage(o(s.auditError,e)),new Error(e.message)},u.getUrl=function(e,t){if(s[e])return t.clickUrl&&(t.clickUrl=i.replaceUrlParams(t.clickUrl,i.extend({},c,t))),o(s[e],t)},u},r.Log.hookReason={TERM_NOT_FOUND:100,OVERLAPPING_TERM:101},r.Log.viewSource={LOAD:100,MOUSE_OVER:200,SCROLL:300},r.Log.clickSource={AD:100,HOOK:200},r.Log.closeSource={AD:100,AUTO:200,FORCE:300},r.Log.headerBid={SUCCESS:100,FAILURE:200};var r=r||{};r.Net=function(e,t,n,i,o){function r(t){var r,a,c=t.scope,s=t.id;return c?(v[c]=v[c]||{},m[c]=m[c]||{},h[c]=v[c],r=h[c]):(c=l,v[c]=v[c]||{},m[c]=m[c]||{},r=e,s=s||"vib_"+g++),a=o.replaceUrlParams(t.url,{callbackId:s,callbackScope:c,id:s}),v[c][s]?m[c][s]:(v[c][s]=o.once(function(e){r[s]=void 0,v[c][s]=void 0,m[c][s].fire("data",e),m[c][s]=void 0}),r[s]=v[c][s],m[c][s]=new i.Observable,n.appendDisposableScript(a),m[c][s])}function a(e){return m[p][e]?m[p][e]:(m[p][e]=new i.Observable,setTimeout(function(){n.appendScript(e+"",function(){m[p][e].fire("load"),m[p][e]=void 0})},1),m[p][e])}function c(t,n){function r(){if(t.headers)for(var e in t.headers)t.headers.hasOwnProperty(e)&&d.setRequestHeader(e,t.headers[e]);"POST"===t.method&&d.setRequestHeader("Content-Type","application/json"),d.withCredentials=!0}var a,c,s,d=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(!t.url)throw new Error("[Net] No URL was specified");t.async=t.async!==!1,t.method=t.method||"POST",a=o.once(function(){n(null,JSON.parse(d.responseText))}),c=o.once(function(){n(new Error("[Net] There was an error sending the request"))}),s=o.once(function(){n(new Error("[Net] Request timed out"))});try{try{i.bind(d,"load",a),i.bind(d,"error",c),i.bind(d,"timeout",s),d.open(t.method,t.url,t.async),r()}catch(u){e.XDomainRequest?(d=new XDomainRequest,d.onprogress=function(){},d.onload=onload,d.onerror=c,d.open(t.method,t.url,t.async),r()):n(new Error("[Net] CORS not supported: "+u))}t.data?d.send(JSON.stringify(t.data)):d.send()}catch(u){n(new Error("[Net] Unable to perform XHR: "+u))}return d.onreadystatechange=function(){4===d.readyState&&d.status>=200&&d.status<300?a():d.status>=400&&c()},d}function s(e,t,i,r){var a;if(!f[i])throw new Error("[Net] Wrong method was used to notify: "+i);return a="iframe"===i?n.appendIFrame(o.replaceUrlParams(e,t||{}),null,r):"script"===i?n.appendScript(o.replaceUrlParams(e,t||{}),null,r):n.dropImage(o.replaceUrlParams(e,t||{}),r),a.style.display="none",a.style.visibility="hidden",a.style.width="1px",a.style.height="1px",a.width=1,a.height=1,a}function d(e,t){return n.openUrl(o.replaceUrlParams(e,t||{}))}function u(e,t){return o.replaceUrlParams(e,t||{})}var l="__default_VM_jsonp__",p="__default_VM_scripts__",h=e[t],f={image:"image",script:"script",iframe:"iframe"},g=0,v={},m={};return m[p]={},{jsonp:r,loadScript:a,xhr:c,notify:s,openUrl:d,compileUrl:u}};var r=r||{},a=2;r.Page=function(e,t,n){function i(i,o,r){"function"==typeof o&&(r=o,o={});var c=!t.nodes||Math.abs(i.length-t.nodes.length)>a;c||(c=n.some(t.nodes,function(e,t){return!i[t]||i[t].getId()!==e})),c?e.contextualise(i,o,r):(e.logContext(t.get("articleHash",t.get("urlHash"))),r({articleHash:t.get("articleHash",null),pubXReached:!!t.pubXReached}))}return{contextualise:i}};var r=r||{};r.PubXBuilder=function(e){r.PubX=e.serviceVersion?r.PubXNEW:r.PubXOLD},r.PubXNEW=function(e){function t(e){i=parseInt(e,10)}function n(t){switch(i){case r.PubXNEW.ALLOW_ALL:case r.PubXNEW.BACKFILL_ONLY:return!0;case r.PubXNEW.BLOCK_ALL:return!1;case r.PubXNEW.BLOCK_IN_CONTENT:return t!==r.PubXNEW.IN_CONTENT;default:throw new e.auditError({
message:"Unknown PubX action "+i})}}var i=r.PubXNEW.ALLOW_ALL;return{set:t,isAllowed:n}},r.PubXNEW.OTHER=0,r.PubXNEW.IN_CONTENT=1,r.PubXNEW.ALLOW_ALL=0,r.PubXNEW.BLOCK_ALL=1,r.PubXNEW.BLOCK_IN_CONTENT=2,r.PubXNEW.BACKFILL_ONLY=3,r.PubXOLD=function(e){function t(e){i=parseInt(e,10)}function n(t){switch(i){case r.PubXOLD.ALLOW_ALL:case r.PubXOLD.BACKFILL_ONLY:return!0;case r.PubXOLD.BLOCK_ALL:return!1;case r.PubXOLD.BLOCK_IN_CONTENT:return t!==r.PubXOLD.IN_CONTENT;default:throw new e.auditError({message:"Unknown PubX action "+i})}}var i=r.PubXOLD.ALLOW_ALL;return{set:t,isAllowed:n}},r.PubXOLD.OTHER=0,r.PubXOLD.IN_CONTENT=1,r.PubXOLD.ALLOW_ALL=1,r.PubXOLD.BLOCK_ALL=2,r.PubXOLD.BLOCK_IN_CONTENT=3,r.PubXOLD.BACKFILL_ONLY=4;var r=r||{};r.Tracking=function(e,t,n,i,o){function a(e){var t=!!e.getAd&&e.getAd().creative.diyValues;n.isObject(t)&&t.hasOwnProperty("bidder")&&e.on("impression",function(){o.fire(r.app.bid.impression,{bidder:t.bidder,product:e.product})})}function c(e,o,r){a(e),o&&o.length&&n.forEach(o,function(o){var a=s[o.trackerType],c=n.extend({timestamp:+new Date},d,o.params||{},r||{});if(!a)throw i.auditError({message:"[Tracking] Unrecognised tracker type: "+o.trackerType});e.on(o.onEvent,function(){t.notify(o.actionUrl,c,a,e.companion||e.outerBox)})})}var s={image:"image",script:"script",iframe:"iframe"},d={ipid:e.ipid,urlHash:e.urlHash,pvu:e.pvu,postcode:e.geo&&e.geo.pc||""};return{track:c}};var r=r||{};r.Utils=function(){function n(t,n,i){var o;return i=i||{},i.leading?function(){o?clearTimeout(o):t.apply(null,arguments),o=e.setTimeout(function(){o=void 0},n)}:function(){var i=arguments;o&&clearTimeout(o),o=e.setTimeout(function(){o=void 0,t.apply(null,i)},n)}}function i(e){return e.replace(x,"\\$&")}function o(e){for(var t=1,n=arguments.length;t<n;++t){var i=arguments[t];if("object"!=typeof i)break;for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])}return e}function r(e,t,n){for(var i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i)}function a(e){for(var t,n=0,i=0,o=e.length;i<o;++i)t=e.charCodeAt(i),n=(n<<5)-n+t,n|=0;return n}function c(e,t){var n=!0;return t=v(t)?t:[t],b(t,function(t){n&&(n=k(e,t))}),!!n}function s(e){if(Object.keys)return 0===Object.keys(e).length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function d(e){return"object"==typeof e&&null!==e&&!v(e)}function u(e,t){var n=!1;return function(){n||(n=!0,e.apply(t,arguments))}}function l(e,t){return e.replace(L,function(e,n){return t.hasOwnProperty(n)?encodeURIComponent(String(t[n])):""})}function p(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}function h(e){var t,n={params:{}};return e.indexOf("?")!==-1&&(t=e.split("?"),n.url=t[0],e=t[1]),e=e.replace(/&amp;/g,"&"),e=0!==e.indexOf("&")?"&"+e:e,b(e.split("&"),function(e){e&&(t=e.split("="),n.params[t[0]]=decodeURIComponent(t[1]))}),n}function f(e,t){return e.length>t?e.substr(0,t-3)+"":e}function g(t){return"number"==typeof t&&e.isFinite(t)}function v(e){return"[object Array]"===Object.prototype.toString.call(e)}function m(t,n,i){function o(){a&&e.clearTimeout(a)}function r(){t()&&n(),a=e.setTimeout(r,i)}var a;return i=i||1e3,a=e.setTimeout(r,i),o}function y(e,t,n){var i=+new Date;i-e>=t&&n()}var b,w,k,E,O,C,I,N,S,T,x=/[.*+?^${}()|[\]\/\\]/g,L=/{{([A-Za-z]\w*)}}/g;return b=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var i=0,o=e.length;i<o;++i)t.call(n,e[i])},w=Object.keys?function(e){return Object.keys(e)}:function(e){var t=[];return r(e,function(e,n){t.push(n)}),t},k=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t)!==-1}:function(e,t){return O(e,function(e){return e===t})},E=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t)}:function(e,t){for(var n=[],i=0,o=e.length;i<o;++i)n.push(t(e[i]));return n},O=Array.prototype.some?function(e,t,n){return Array.prototype.some.call(e,t,n)}:function(e,t,n){for(var i=0,o=e.length;i<o;++i)if(t.call(n,e[i],i))return!0;return!1},C=Array.prototype.filter?function(e,t,n){return Array.prototype.filter.call(e,t,n)}:function(e,t,n){for(var i=[],o=0;o<e.length;o++)t.call(n,e[o],o,e)&&i.push(e[o]);return i},I=String.prototype.trim?function(e){return e.trim()}:function(e){return e=e.replace(/^\s+|\s+$/g,"")},N=function(){function e(e){return encodeURIComponent(t(e))}function t(e){for(var t,i,o,r,a,c,s,d="",u=0;u<e.length;)t=e.charCodeAt(u++),i=e.charCodeAt(u++),o=e.charCodeAt(u++),r=t>>2,a=(3&t)<<4|i>>4,c=(15&i)<<2|o>>6,s=63&o,isNaN(i)?(c=64,s=64):isNaN(o)&&(s=64),d+=n.charAt(r)+n.charAt(a)+n.charAt(c)+n.charAt(s);return d}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:t,encodeURI:e}}(),S=function(){var n,i,o,r=e.navigator.userAgent,a=r.indexOf("MSIE");if(a>-1){n=3,i=t.createElement("div"),o=i.all||[];do i.innerHTML="<!--[if gt IE "+ ++n+"]><br><![endif]-->";while(o[0]);return n>4&&n}return!1}(),T=function(e){return e?function(e){return e&&"number"==typeof e.length&&"undefined"!=typeof e.item&&"undefined"==typeof e.push&&"undefined"==typeof e.pop}:function(e){return e instanceof NodeList}}(!!S),{debounce:n,escapeRegExp:i,extend:o,forEach:b,forOwn:r,keys:w,hashString:a,includes:k,includesAll:c,isEmpty:s,isObject:d,map:E,once:u,some:O,filter:C,replaceUrlParams:l,toQueryString:p,parseQueryString:h,trim:I,truncate:f,isFiniteNumber:g,isArray:v,poll:m,timeDeltaPassed:y,Base64:N,isIE:S,isNodeList:T}};var r=r||{};r.Waterfall=function(e,t,n,i,o){function r(i){var r,a,c=n.get("partner."+i+".runcheck",null);if(null===c)return!1;switch(r=c.get("type"),a=c.get("value"),r){case"css":return null!==t.querySelector(a);case"var":return e.hasOwnProperty(a);default:throw o.auditError({message:"[Waterfall] Unknown run check type: "+r})}}function a(t){if(i.isObject(e.VMNoAds)&&"function"==typeof e.VMNoAds[t])try{o.auditError({message:"[Waterfall] Failed loading product: "+t}),e.VMNoAds[t]()}catch(n){}}return{isBlocked:r,notifyFailure:a}};var c=c||{};c.BidDetails=function(e,t){var n={CRITEO:15},i={success:!1},o=function(){return{success:!0,products:[]}},r={intext:/^v[0-9]+([a-z])?i([A-Z][0-9])?$/,image:/^v[0-9]+([a-z])?img([A-Z][0-9])?$/,daw:/^v[0-9]+([a-z])?a([A-Z][0-9])?$/},a={criteo:{script:'function crtg_getCookie(e){var t,r,a,c=document.cookie.split(";");for(t=0;t<c.length;t++)if(r=c[t].substr(0,c[t].indexOf("=")),a=c[t].substr(c[t].indexOf("=")+1),r=r.replace(/^s+|s+$/g,""),r==e)return unescape(a);return""}var crtg_nid="6003",crtg_cookiename="crtg_rta",crtg_varname="crtg_content",crtg_content=crtg_getCookie(crtg_cookiename),crtg_rnd=Math.floor(99999999999*Math.random());!function(){var e=location.protocol+"//rtax.criteo.com/delivery/rta/rta.js?netId="+escape(crtg_nid);e+="&cookieName="+escape(crtg_cookiename),e+="&rnd="+crtg_rnd,e+="&varName="+escape(crtg_varname);var t=document.createElement("script");t.type="text/javascript",t.src=e,t.async=!0,document.getElementsByTagName("head").length>0?document.getElementsByTagName("head")[0].appendChild(t):document.getElementsByTagName("body").length>0&&document.getElementsByTagName("body")[0].appendChild(t)}();',adProvider:n.CRITEO,callback:function(e){var n,a,c=e.crtg_content;return c?(a=c.split(";"),n=o(),n.impressionCap=2,n.params={},t.forOwn(r,function(e,i){a.forEach(function(o){e.test(o)&&(t.includes(n.products,i)||(n.products.push(i),n.params[i]=[]),n.params[i].push(o))})}),n):i}}};return a};var c=c||{};c.CompatibilityRules=function(e){return[{type:"execute",args:[[function(t){var n=t.get("partner.intext.inview",{}),i=t.partner.inview=t.partner.inview||{};e.extend(i,n)}]]}]};var c=c||{};c.ProductMap=function(){var e={1:"intext",2:"image",3:"inline",4:"adhesion",5:"inview",6:"adbar"};return{hash:e}};var s=s||{};s.Banner=function(e,t,n,i){function o(o){var a=o.template.params,c=o.getDiyValues().nohookclick||!1;return e.create({width:parseInt(a.width,10),height:parseInt(a.height,10),load:function(){function e(e){function t(){n.clickThrough(i.extend(u,{source:e}))}var a;e===r.Log.clickSource.HOOK&&c||(a=o.getClickDelay(),i.timeDeltaPassed(o.openTime,a,t))}var s=o.getAd(),d=o.getAdConfig(),u={product:o.product,hookId:d.vibrantParameters.hookId,keyword:encodeURIComponent(d.term&&d.term.keyword||""),timestamp:+new Date,clickUrl:s.clickUrl},l=t.createIFrame({width:a.width,height:a.height},function(e,t){t.contentWindow.contents=s.creative.diyValues.iframe,t.src="javascript:window['contents']"});s.clickUrl&&(o.on(o.EVENT_CLICK,function(){e(r.Log.clickSource.AD)}),o.on("delegate",function(t){"click"===t.data.triggerSource&&e(t.data.source)})),o.fire("loaded",l)}})}return{create:o}};var s=s||{};s.C2S=function(n,i){function o(t,n){var i=0;return function o(){e.setTimeout(function(){if(n.contentWindow&&n.contentWindow.pbCall)t.fire("close",r.Log.closeSource.FORCE);else if(n.contentDocument&&n.contentDocument.body&&n.contentDocument.body.childNodes.length>=c)return;++i<d?o():t.fire("close",r.Log.closeSource.FORCE)},s)}}function a(e){return n.create({width:parseInt(e.settings.ads[0].width,10),height:parseInt(e.settings.ads[0].height,10),load:function(){var n=t.createElement("script");n.type="text/javascript",n.src=e.template.id;var r=i.createIFrame({width:e.settings.ads[0].width,height:e.settings.ads[0].height},function(t,i){i.contentWindow.contents=n.outerHTML,i.src="javascript:window['contents']",setTimeout(o(e,i),1)});e.fire("loaded",r)}})}var c=3,s=500,d=3;return{create:a}};var s=s||{};s.CPE=function(e,t){function n(n){return e.create({load:function(){var e=this;t.load({adInstance:n,templateData:n.template},function(t){e.width=parseInt(t.width,10),e.height=parseInt(t.height,10),n.fire("loaded",t.element)})}})}return{create:n}};var s=s||{};s.Custom=function(e,t){function n(n){var i=n.template.params,o=i.scaleToWidth?!!parseInt(i.scaleToWidth,10):null;return"image"===n.product&&o!==!1||o?(i.width=n.settings.container&&n.settings.container.width||parseInt(i.width,10),i.scaleToHeight?i.height=n.settings.container&&n.settings.container.height||parseInt(i.height,10):i.height=parseInt(i.height,10)):(i.width=parseInt(i.width,10),i.height=parseInt(i.height,10)),e.create({load:function(){var e=this;t.load({adInstance:n,templateData:n.template},function(t){e.width=parseInt(t.width,10),e.height=parseInt(t.height,10),n.fire("loaded",t.element)})}})}return{create:n}};var s=s||{};s.Standard=function(e,n,i,o){function a(a){var s,d,u=a.template.params,l=u.scaleToWidth?!!parseInt(u.scaleToWidth,10):null,p=a.getDiyValues().nohookclick||!1;return"image"===a.product&&l!==!1||l?(s=a.settings.container&&a.settings.container.width||parseInt(u.width,10),d=u.scaleToHeight?a.settings.container&&a.settings.container.height||parseInt(u.height,10):parseInt(u.height,10)):(s=parseInt(u.width,10),d=parseInt(u.height,10)),e.create({width:s,height:d,load:function(){function e(e){function t(){i.clickThrough(o.extend(v,{source:e}))}var n;e===r.Log.clickSource.HOOK&&p||(n=a.getClickDelay(),o.timeDeltaPassed(a.openTime,n,t))}var l,h=a.getAd(),f=a.getAdConfig(),g=t.createElement("div"),v={product:a.product,hookId:f.vibrantParameters.hookId,keyword:encodeURIComponent(f.term&&f.term.keyword||""),timestamp:+new Date,clickUrl:h.clickUrl},m=o.extend({},v,u,h.creative.diyValues||{},{clickUrl:i.getUrl("clickThrough",o.extend(v,{source:r.Log.clickSource.AD}))});m.hasOwnProperty("description")&&m.description&&(m.description=o.truncate(m.description,c)),g.innerHTML=a.template.execute(m),g.firstChild.width=s,g.firstChild.height=d,g.firstChild.style&&(g.firstChild.style.width=s+"px",g.firstChild.style.height=d+"px",g.firstChild.style.margin="0px",g.firstChild.style.padding="0px",g.firstChild.style["max-width"]=s+"px",g.firstChild.style["max-height"]=d+"px"),l=g.firstChild,n.bind(l,"click",function(){e(r.Log.clickSource.AD)}),a.on(a.EVENT_CLICK,function(){e(r.Log.clickSource.HOOK)}),a.on("delegate",function(t){"click"===t.data.triggerSource&&e(t.data.source)}),a.fire("loaded",l)}})}var c=200;return{create:a}};var s=s||{};s.Video=function(e,t){function n(n){var i=n.getAd(),o=parseInt(n.template.params.width,10)||i.width,r=parseInt(n.template.params.height,10)||i.height;return e.create({width:o,height:r,load:function(){var e=n.settings.ads[0].creative.diyValues;n.template.params.vast=e.vpaid||e.VastAdTagUri||n.template.params.vast,n.template.params.width=o,n.template.params.height=r,t.load({adInstance:n,templateData:n.template},function(e){n.fire("loaded",e.element)},"videoFrame")}})}return{create:n}};var s=s||{};s.Waterfall=function(e){function t(t,n,o){var r=t.getAd(),a=r.creative,c=a.diyValues||{},s=o,d=r.hook||{},u=a.creativeType;return c.VastAdTagUri||c.vpaid?{creative:e.video.create(t),decoration:s}:"c2s"===u||t.template.params.c2s?{creative:e.c2s.create(t),decoration:s}:t.template.params.isCPE?("inview"!==n&&(s=i),{creative:e.cpe.create(t),decoration:s}):t.template.params.isCustom?("adbar"===n&&(s="image"),{creative:e.custom.create(t),decoration:s}):c.iframe?{creative:e.banner.create(t),decoration:s}:(d&&d.isHibu&&(s="legacyadhesion"),"adbar"===n&&(s="image"),{creative:e.standard.create(t),decoration:s})}function n(e,t,n){return(o[t]||o.fallback)(e,t,n)}var i="cpeProgressBar",o={inline:t,daw:t,adhesion:t,image:t,inview:t,tooltip:t,adbar:t,fallback:t};return{select:n,creatives:e}};var d=d||{},u=50;d.Hook=function(t,n,i,o,r,a){function c(n,r,c){var s,u,l=this,f=null,g=t.createElement("span");g.className="vm-hook",i.setTextContent(g,n);var v=t.createElement("span");v.className="vm-hook-icon",this.domNode=t.createElement("span"),this.domNode.className="vm-hook-outer",c.custom?this.domNode.className+=" vm-hook-custom":(s=c.get("colour","#009900"),this.domNode.className+=" vm-hook-default",g.style.color=s,g.style.borderColor="transparent transparent "+s,v.style.display=c.get("icon","inline-block")),this.domNode.appendChild(g),this.domNode.appendChild(v),r.product=a.hash[r.vibrantParameters.product],this.adConfig=r,this.id=r.vibrantParameters.hookId,this.triggered=!1,o.Observable.call(this),h?o.bind(this.domNode,"click",function(e){o.stopPropagation(e),l.fire(d.Hook.EVENT_CLICK,{hook:l,event:e})}):(o.bind(this.domNode,"mouseenter",function(t){e.clearTimeout(f),f=e.setTimeout(function(){f=null,l.fire(d.Hook.EVENT_HOOKIN,{hook:l,event:t}),u||(u=o.bind(l.domNode,"click",function(e){o.stopPropagation(e),l.fire(d.Hook.EVENT_CLICK,{hook:l,event:e})}))},p)}),o.bind(this.domNode,"mouseleave",function(t){u&&(u(),u=null),f?(e.clearTimeout(f),f=null):l.fire(d.Hook.EVENT_HOOKOUT,{hook:l,event:t})}))}function s(e,i){function o(){return d.charAt(p.index)===u.charAt(0)?p.index:p.index+1}var a=e.getDomNode(),s=a.data,d=s.toLowerCase(),u=r.escapeRegExp(i.term.keyword),l="(^|\\s|\\\"|\\')"+u+"(\\s|$|\\.|\\,|\\?|\\!|\\\"|\\')",p=new RegExp(l,"m").exec(d);if(!p||p.len<1)return null;if(!a.parentNode)return null;var h=o(),g=h+u.length,v=new c(s.substring(h,g),i,n.get("partner.hook.style",{})),m=t.createDocumentFragment();return m.appendChild(t.createTextNode(s.substring(0,h))),m.appendChild(v.getDomNode()),m.appendChild(t.createTextNode(s.substring(g))),a.parentNode.replaceChild(m,a),e.addHook(v),e.updateDomNode(v.getDomNode()),f.push(v),v}function l(e){return r.filter(f,function(t){var n=i.isInViewport(t.getDomNode());return e?e===t.getAdConfig().product&&n:n})}var p=n.get("partner.intext.opendelay",u),h=n.get("mobile",!1),f=[];return c.prototype=new o.Observable,c.prototype.getId=function(){return this.id},c.prototype.getProduct=function(){return this.adConfig.product},c.prototype.getDomNode=function(){return this.domNode},c.prototype.getPosition=function(){return i.getPosition(this.domNode)},c.prototype.getAdConfig=function(){return this.adConfig},c.prototype.setTriggered=function(){this.triggered=!0},c.prototype.hasBeenTriggered=function(){return this.triggered},c.prototype.isInViewport=function(){return i.getAbsoluteViewport().contains(this.getPosition())},c.prototype.isInViewportArea=function(e){var t=i.getAbsoluteViewport();return e=e||1,t.bottom=i.getWinHeight()*e+i.getScrollY(),t.contains(this.getPosition())},c.prototype.getParagraph=function(){return i.findParentParagraph(this.domNode)},c.prototype.getParagraphPosition=function(){return i.getPosition(this.getParagraph())},{create:s,getVisibleHooks:l,Hook:c}},d.Hook.EVENT_CLICK="vm:hookclick",d.Hook.EVENT_HOOKIN="vm:hookin",d.Hook.EVENT_HOOKOUT="vm:hookout";var d=d||{};d.Image=function(e,n,i){function o(e){var t,i=this;this.id=s++,this.image=e,this.locked=!1,e.width>0&&e.height>0?this.allowed=c(e):(this.allowed=!1,e.complete||(t=n.bind(e,"load",function(){i.allowed=c(e),t()})))}function a(e){function n(e){e.nodeType===r.Dom.ELEMENT_NODE&&("IMG"===e.tagName.toUpperCase()?a.push(new o(e)):i.forEach(e.childNodes,n))}var a=[],c=e;return i.isNodeList(c)||(c=t.querySelectorAll(e)),i.forEach(c,n),a}function c(e){var t=e.width,n=e.height;return e.width>=d&&e.height>=u&&!l[t+"x"+n]}var s=1,d=200,u=250,l={"300x250":!0,"300x600":!0},p=.8;return o.prototype.getId=function(){return this.id},o.prototype.getDomNode=function(){return this.image},o.prototype.getWidth=function(){return this.image.width},o.prototype.getHeight=function(){return this.image.height},o.prototype.isAvailable=function(){return this.allowed&&!this.locked},o.prototype.lock=function(){this.locked=!0},o.prototype.setAdUnit=function(e){this.adUnit=e},o.prototype.hasAdUnit=function(){return!!this.adUnit},o.prototype.getPosition=function(){return e.getPosition(this.image)},o.prototype.getArea=function(){return this.getPosition().getArea()},o.prototype.isInViewport=function(){var t,n;return this.adUnit&&this.adUnit.isReady()?this.adUnit.isInViewport():(t=this.getPosition(),n=this.getHeight(),t.top=t.top+n*p,!!e.getAbsoluteViewport().contains(t))},o.prototype.isVisible=function(){return e.isVisible(this.image,{overflowCheck:!0})},{ImageNode:o,findImages:a}};var d=d||{};d.Paragraph=function(e,n){function i(e){this.id=s++,this.domNode=e,this.available=!0}function o(e){var t=e.textContent;return"undefined"==typeof t&&(t=e.nodeType===r.Dom.TEXT_NODE?e.data:e.innerText),t.replace(/\s+/,"").length}function a(e){return n.some(e.childNodes,function(e){return e.nodeType===r.Dom.TEXT_NODE&&o(e)>0})}function c(r){var c=t.querySelectorAll(r.selectors),s=[];return n.forEach(c,function(t){var c=t.querySelectorAll(r.paragraphselectors);n.forEach(c,function(t){var n;e.getPosition(t).getWidth()<r.adwidth||a(t)&&(o(t)<r.mincontentlength.above||(n=e.nextElementSibling(t),null===n||o(n)<r.mincontentlength.below||s.push(new i(t))))})}),s}var s=1;return i.prototype.getId=function(){return this.id},i.prototype.getDomNode=function(){return this.domNode},i.prototype.getWidth=function(){return e.getPosition(this.domNode).getWidth()},i.prototype.isBelowWaterline=function(){return e.getPosition(this.domNode).bottom>=e.getAbsoluteViewport().bottom},i.prototype.isAvailable=function(){return this.available},i.prototype.lock=function(){this.available=!1},{findParagraphs:c,Paragraph:i}};var d=d||{};d.TextNode=function(e,t){function n(e,i,o){this.id=t.hashString(i),this.domNode=e,this.textContent=i,this.hyperlink=o,this.status=n.AVAILABLE,this.hooks=[]}function i(i){function c(e,i){var d,u;if(e.nodeType===r.Dom.TEXT_NODE)d=t.trim(e.data),d.length>0&&s.push(new n(e,d,i));else if(e.nodeType===r.Dom.ELEMENT_NODE){if(u=e.tagName.toUpperCase(),o[u]||e.className&&e.className.toLowerCase&&t.includes(e.className.toLowerCase().split(/\s+/),a)||e.id&&e.id.toLowerCase&&e.id.toLowerCase()===a)return;t.forEach(e.childNodes,function(e){c(e,i||"A"===u)})}}var s=[],d=i;return t.isNodeList(d)||(d=e.querySelectorAll(i)),t.forEach(d,function(e){c(e,!1)}),s}var o={SCRIPT:!0,NOSCRIPT:!0,CANVAS:!0,CODE:!0,OBJECT:!0,PROGRESS:!0,SOURCE:!0,VIDEO:!0,STYLE:!0},a="nointellitxt";return n.AVAILABLE=0,n.IN_FLIGHT=1,n.LOCKED=2,n.prototype.getId=function(){return this.id},n.prototype.getDomNode=function(){return this.domNode},n.prototype.updateDomNode=function(e){this.domNode=e},n.prototype.isHyperlink=function(){return this.hyperlink},n.prototype.getTextContent=function(){return this.textContent},n.prototype.getStatus=function(){return this.status},n.prototype.setStatus=function(e){this.status=e},n.prototype.getHooks=function(){return this.hooks},n.prototype.addHook=function(e){this.hooks.push(e)},{TextNode:n,findTextNodes:i}};var l=l||{};l.desktop=function(e,t,n,i,o,a){function c(){var c={};return c.daw=function(){var n=new i.Scroll,o=new i.Adhesion(t.get("partner.daw",{})),r=new e.Daw;n.initialise(),o.once("trigger",function(e){r.invoke(e.data)}),o.initialise(n)},n.isAllowed(r.PubX.IN_CONTENT)?(c.image=function(n){var o=new i.Image(t.get("partner.image",{})),r=i.Gallery.load(t.get("partner.gallery",{})),a=new e.Image;o.on("trigger",function(e){a.invoke(e.data)}),function(){var t;r&&(t=new e.Gallery({api:r.api}),r.on("trigger",function(e){a.invoke(e.data)}),a.on("galleryBehaviour",function(e){t.invoke(e.data)}))}(),o.initialise(n)},c.inline=function(n){var o=new i.ParagraphBreak(t.get("partner.inline",{})),r=new e.Inline;o.on("trigger",function(e){r.invoke(e.data)}),o.initialise(n)},function(){var n=t.getBoolean("partner.inview.mobileonly",!1),s=new i.TextNode,d=new e.Wordflip,u=new e.VibrantView,l=e.ScriptsLoader,p=a.once(function(e){s.initialise(e)});c.intext=function(t,n){function i(e){d.invoke(e),u.invoke(e),l.invoke(e)}function o(e){a.invoke(e)}function r(e){a.invoke(e)}var a=new e.Tooltip,c=new e.Hook({product:n,fetchFormat:"{{id}}",eventCallbacks:{newHooks:i,hover:o,click:r}});s.on("trigger",function(e){c.invoke(e.data)}),u.on("trigger",function(e){n===e.data.hook.getProduct()&&a.invoke(e.data)}),p(t)},c.inview=function(t,i){function a(t){e.AutoReveal.autoOpen(g,t)}function c(e){d.invoke(e),u.invoke(e),l.invoke(e),a(e)}function h(e){g.invoke(e)}function f(e){g.invoke(e)}if(!n){var g=new e.InView,v=new e.Hook({product:i,fetchFormat:"{{id}}:{{width}}:"+i,callback:g.processNode,eventCallbacks:{newHooks:c,hover:h,click:f}});s.on("trigger",function(e){v.invoke(e.data)}),u.on("trigger",function(e){i===e.data.hook.getProduct()&&g.invoke(e.data)}),t.on(r.app.trigger.scroll,function(){a({hooks:o.getVisibleHooks(i),viewSource:r.Log.viewSource.SCROLL})}),p(t)}},c.adbar=function(){var n=new i.Scroll,o=new i.Adhesion(t.get("partner.adbar",{})),r=new e.AdBar;n.initialise(),o.once("trigger",function(e){r.invoke(e.data)}),o.initialise(n)},c.adbarlegacy=function(){e.AdBarLegacy()}}(),c):c}return{initialise:c}};var l=l||{};l.mobile=function(e,t,n,i,o,a){function c(){var c={};if(n.isAllowed(r.PubX.IN_CONTENT)){var s=new i.Resize,d=new i.Scroll,u=new i.Gesture;return s.initialise(),d.initialise(),u.initialise(),c.image=function(n){var o=new i.Image(t.get("partner.image",{})),r=i.Gallery.load(t.get("partner.gallery",{})),a=new e.Image;o.on("trigger",function(e){a.invoke(e.data)}),function(){var t;r&&(t=new e.Gallery({api:r.api}),r.on("trigger",function(e){a.invoke(e.data)}),a.on("galleryBehaviour",function(e){t.invoke(e.data)}))}(),o.initialise(n)},c.inline=function(n){var o=new i.ParagraphBreak(t.get("partner.inline",{})),r=new e.Inline;o.on("trigger",function(e){r.invoke(e.data)}),o.initialise(n)},c.adhesion=function(){var n=new i.Adhesion(t.get("partner.adhesion",{})),o=new e.AdhesionBackfill({fetchFormat:"{{id}}:320:80"}),r=new e.AdhesionPlacement;s.connect("trigger",r,"resize"),d.connect("trigger",r,"scroll"),u.connect("zoom",r,"zoom"),o.on("adsReady",function(e){r.invoke(e.data)}),r.on("fetchAd",function(e){o.invoke(e.data)}),n.once("trigger",function(e){o.invoke(e.data)}),n.initialise(d)},function(){var n=t.getBoolean("partner.inview.desktoponly",!1),l=new i.TextNode,p=new e.VibrantView,h=new e.Wordflip,f=e.ScriptsLoader,g=a.once(function(e){l.initialise(e)});s.connect("trigger",h,"resize"),d.connect("trigger",h,"scroll"),u.connect("zoom",h,"zoom"),u.connect("touchstart",h,"touchstart"),u.connect("touchend",h,"touchend"),s.connect("trigger",p,"resize"),d.connect("trigger",p,"scroll"),u.connect("zoom",p,"zoom"),u.connect("touchstart",p,"touchstart"),u.connect("touchend",p,"touchend"),c.intext=function(n,i){function o(e){a.invoke(e)}function r(e){h.invoke(e),p.invoke(e),f.invoke(e)}var a,c,v=i+":",m=t.getBoolean("partner.intext.adhesion",!1),y={newHooks:r,click:o};m?(a=new e.AdhesionPlacement,c=new e.Hook({product:i,placement:"hooked-adhesion",fetchFormat:"{{id}}:320:80",eventCallbacks:y}),h.on(v+"highlight",function(e){a.invoke(e.data)}),s.connect("trigger",a,"resize"),d.connect("trigger",a,"scroll"),u.connect("zoom",a,"zoom"),u.connect("touchstart",a,"touchstart"),u.connect("touchend",a,"touchend")):(a=new e.DropInPlacement,c=new e.Hook({product:i,placement:"dropin",fetchFormat:"{{id}}:1:1",eventCallbacks:y})),l.on("trigger",function(e){c.invoke(e.data)}),g(n)},c.inview=function(t,i){function a(e){d.invoke(e)}function c(t){e.AutoReveal.autoOpen(d,t)}function s(e){h.invoke(e),p.invoke(e),f.invoke(e),c(e)}if(!n){var d=new e.InView,u=new e.Hook({product:i,fetchFormat:"{{id}}:{{width}}:"+i,callback:d.processNode,eventCallbacks:{newHooks:s,click:a}});l.on("trigger",function(e){u.invoke(e.data)}),p.on("trigger",function(e){i===e.data.hook.getProduct()&&d.invoke(e.data)}),t.on(r.app.trigger.scroll,function(){c({hooks:o.getVisibleHooks(i),viewSource:r.Log.viewSource.SCROLL})}),g(t)}}}(),c}}return{initialise:c}};var l=l||{};l.tablet=function(e,t,n,i,o,a){function c(){var c={};if(n.isAllowed(r.PubX.IN_CONTENT)){var s=new i.Resize,d=new i.Scroll,u=new i.Gesture;return s.initialise(),d.initialise(),u.initialise(),c.image=function(n){var o=new i.Image(t.get("partner.image",{})),r=i.Gallery.load(t.get("partner.gallery",{})),a=new e.Image;o.on("trigger",function(e){a.invoke(e.data)}),function(){var t;r&&(t=new e.Gallery({api:r.api}),r.on("trigger",function(e){a.invoke(e.data)}),a.on("galleryBehaviour",function(e){t.invoke(e.data)}))}(),o.initialise(n)},c.inline=function(n){var o=new i.ParagraphBreak(t.get("partner.inline",{})),r=new e.Inline;o.on("trigger",function(e){r.invoke(e.data)}),o.initialise(n)},c.adhesion=function(){var n=new i.Adhesion(t.get("partner.adhesion",{})),o=new e.AdhesionBackfill({fetchFormat:"{{id}}:728:90"}),r=new e.AdhesionPlacement;s.connect("trigger",r,"resize"),d.connect("trigger",r,"scroll"),u.connect("zoom",r,"zoom"),o.on("adsReady",function(e){r.invoke(e.data)}),r.on("fetchAd",function(e){o.invoke(e.data)}),n.once("trigger",function(e){o.invoke(e.data)}),n.initialise(d)},function(){var n=t.getBoolean("partner.inview.desktoponly",!1),l=new i.TextNode,p=new e.VibrantView,h=new e.Wordflip,f=e.ScriptsLoader,g=a.once(function(e){l.initialise(e)});s.connect("trigger",h,"resize"),d.connect("trigger",h,"scroll"),u.connect("zoom",h,"zoom"),u.connect("touchstart",h,"touchstart"),u.connect("touchend",h,"touchend"),s.connect("trigger",p,"resize"),d.connect("trigger",p,"scroll"),u.connect("zoom",p,"zoom"),u.connect("touchstart",p,"touchstart"),u.connect("touchend",p,"touchend"),c.intext=function(n,i){function o(e){a.invoke(e)}function r(e){h.invoke(e),p.invoke(e),f.invoke(e)}var a,c,v=i+":",m=t.getBoolean("partner.intext.adhesion",!1),y={newHooks:r,click:o};m?(a=new e.AdhesionPlacement,c=new e.Hook({product:i,placement:"hooked-adhesion",fetchFormat:"{{id}}:728:90",eventCallbacks:y}),h.on(v+"highlight",function(e){a.invoke(e.data)}),s.connect("trigger",a,"resize"),d.connect("trigger",a,"scroll"),u.connect("zoom",a,"zoom"),u.connect("touchstart",a,"touchstart"),u.connect("touchend",a,"touchend")):(a=new e.DropInPlacement,c=new e.Hook({product:i,placement:"dropin",fetchFormat:"{{id}}:1:1",eventCallbacks:y})),l.on("trigger",function(e){c.invoke(e.data)}),g(n)},c.inview=function(t,i){function a(e){d.invoke(e)}function c(t){e.AutoReveal.autoOpen(d,t)}function s(e){h.invoke(e),p.invoke(e),f.invoke(e),c(e)}if(!n){var d=new e.InView,u=new e.Hook({product:i,fetchFormat:"{{id}}:{{width}}:"+i,callback:d.processNode,eventCallbacks:{newHooks:s,click:a}});l.on("trigger",function(e){u.invoke(e.data)}),p.on("trigger",function(e){i===e.data.hook.getProduct()&&d.invoke(e.data)}),t.on(r.app.trigger.scroll,function(){c({hooks:o.getVisibleHooks(i),viewSource:r.Log.viewSource.SCROLL})}),g(t)}}}(),c}}return{initialise:c}};var p=p||{};p.Adhesion=function(e){function t(t){e.Observable.call(this),this.minScroll=t.getInteger("minscroll",0),this.triggered=!1}var n={TRIGGER:"trigger"};return t.prototype=new e.Observable,t.prototype.initialise=function(e){var t=this;e.on(n.TRIGGER,function(e){var i=e.data,o=i.scroll||0;!t.triggered&&o>=t.minScroll&&t.fire(n.TRIGGER,{viewSource:i.viewSource||r.Log.viewSource.SCROLL,scroll:o})})},t};var p=p||{};p.Gallery=function(e,n,i,o,a,c,s){function d(e){var t=this;i.Observable.call(this),this.selectors=e.selectors,this.script=e.script,this.gallery=e.gallery,this.api={channel:new i.Observable,config:n,dom:a,events:i,utils:o,selectors:this.selectors,gallery:this.gallery},this.api.channel.on("newImage",function(e){var n=new c.ImageNode(e.data.image);t.fire(l.TRIGGER,{hooks:[n],maxAds:1,viewSource:r.Log.viewSource.LOAD,gallery:!0}),n.isInViewport()&&s.forceFlush()}),this.loadScript()}function u(e){var n,i=e.getArray("selectors",!1),o=e.get("script",!1);return!(!i&&!o)&&(n=t.querySelector(i),!!n&&new d({selectors:i,script:o,gallery:n}))}var l={TRIGGER:"trigger"};return d.prototype=new i.Observable,d.prototype.loadScript=function(){var t=this;e.VM.gallery=e.VM.gallery||{},e.VM.gallery.initialise=function(e){e(t.api)},a.appendScript(this.script)},{GalleryTrigger:d,load:u}};var p=p||{};p.Gesture=function(t,n,i,o){function a(){n.Observable.call(this),this.connect(r.app.trigger.zoom,t)}function c(t){n.bind(e,"touchstart",o.debounce(function(e){t.fire(r.app.trigger.touchstart,e)},s,{leading:!0})),n.bind(e,"touchend",o.debounce(function(e){t.fire(r.app.trigger.touchend,e)},s,{leading:!0}))}var s=150;return a.prototype=new n.Observable,a.prototype.initialise=function(){c(this)},a};var p=p||{};p.Image=function(e,t){function n(t){e.Observable.call(this),this.config=t,this.images=[]}function i(e,n){var i=[],r=e.config.getInteger("maxhooks",1);t.forEach(e.images,function(e){e.isInViewport()&&(e.isAvailable()?(e.lock(),e.isVisible()&&i.push(e)):e.hasAdUnit()?--r:e.lock())}),r<1||0===i.length||(i.sort(function(e,t){return t.getArea()-e.getArea()}),e.fire(o.TRIGGER,{hooks:i,maxAds:r,viewSource:n}))}var o={TRIGGER:"trigger"};return n.prototype=new e.Observable,n.prototype.initialise=function(e){e.on(r.app.trigger.newContent,function(e){this.images.push.apply(this.images,e.data.images)},this),e.on(r.app.trigger.load,function(){i(this,r.Log.viewSource.LOAD)},this),e.on(r.app.trigger.scroll,function(){i(this,r.Log.viewSource.SCROLL)},this)},n};var p=p||{};p.ParagraphBreak=function(e,t,n){function i(e){t.Observable.call(this),this.config=e}var o={TRIGGER:"trigger"};return i.prototype=new t.Observable,i.prototype.initialise=function(t){t.on(r.app.trigger.load,function(){var t=e.findParagraphs(this.config);if(this.config.getBoolean("nowaterline"))this.hook=t[0];else for(var i=0,o=t.length;i<o;++i)if(t[i].isBelowWaterline()){this.hook=t[i];break}this.hook||n.notifyFailure("inline")},this),t.on(r.app.trigger.scroll,function(){this.hook&&this.hook.isAvailable()&&!this.hook.isBelowWaterline()&&(this.hook.lock(),this.fire(o.TRIGGER,{hook:this.hook,viewSource:r.Log.viewSource.SCROLL}))},this)},i};var p=p||{};p.Resize=function(t,n,i){function o(){n.Observable.call(this)}var a={TRIGGER:"trigger"},c=250;return o.prototype=new n.Observable,o.prototype.initialise=function(){var o=this;n.bind(e,"resize",i.debounce(function(){t.fire(r.app.trigger.resize),o.fire(a.TRIGGER)},c))},o};var p=p||{};p.Scroll=function(e,t,n){function i(){var e=this;n.Observable.call(this),this.lastScrollY=0,this._isUnderAnimation=!1,this.onAnimationStart=function(){e._isUnderAnimation=!0},this.onAnimationEnd=function(){e._isUnderAnimation=!1}}var o={TRIGGER:"trigger"};return i.prototype=new n.Observable,i.prototype.initialise=function(){e.on(r.app.inview.animationStart,this.onAnimationStart),e.on(r.app.inline.animationStart,this.onAnimationStart),e.on(r.app.inview.animationEnd,this.onAnimationEnd),e.on(r.app.inline.animationEnd,this.onAnimationEnd),
e.on(r.app.trigger.load,function(){this.lastScrollY=0,this.fire(o.TRIGGER,{viewSource:r.Log.viewSource.LOAD,scroll:0,direction:0})},this),e.on(r.app.trigger.scroll,function(){var e=t.getScrollY(),n=e-this.lastScrollY;this.lastScrollY=e,this._isUnderAnimation||this.fire(o.TRIGGER,{viewSource:r.Log.viewSource.SCROLL,scroll:e,direction:n})},this)},i};var p=p||{};p.TextNode=function(e,t,n,i){function o(){n.Observable.call(this)}var a={TRIGGER:"trigger"},c=40,s=e.getInteger("partner.intext.extendviewport",0);return o.prototype=new n.Observable,o.prototype.initialise=function(e){function n(e,t){var n=i.filter(o,function(e){return d(e.getDomNode())});o.length>0&&e.fire(a.TRIGGER,{nodes:n,viewSource:t})}var o=[],d=function(){return s?function(e){var n=t.getAbsoluteViewport();return n.bottom+=s,!!t.getTextNodeBounds(e).getIntersection(n)}:function(e){return t.isInViewport(e)}}();e.on(r.app.trigger.newContent,function(e){i.forEach(e.data.textNodes,function(e){e.getTextContent().length>=c&&!e.isHyperlink()&&o.push(e)},this)},this),e.on(r.app.trigger.load,function(){n(this,r.Log.viewSource.LOAD)},this),e.on(r.app.trigger.scroll,function(){n(this,r.Log.viewSource.SCROLL)},this)},o};var i=i||{};i.hook=i.hook||{},i.hook.AdAssign=function(e,t,n,i,o,a){function c(t){var c=[],u=t.ads,l=t.candidateNodes,p=t.viewSource,h=t.product;e.forEach(l,function(e){var t,s=e.getId(),d=u[s]?u[s][0]:null;a.setNodeStatus(h,s,o.TextNode.LOCKED),d&&a.hookAllowed()&&(a.countHook(),t=i.create(e,u[s][0]),t?c.push(t):n.hookFailure({product:h||"intext",hookId:d.vibrantParameters.hookId,reason:r.Log.hookReason.TERM_NOT_FOUND}))}),e.forEach(c,function(e){e.on(d.Hook.EVENT_HOOKIN,function(){e.setTriggered(),a.executeCallback(h,s.HOVER,{hook:e,viewSource:r.Log.viewSource.MOUSE_OVER,triggerSource:s.HOVER})}),e.on(d.Hook.EVENT_CLICK,function(){e.setTriggered(),a.executeCallback(h,s.CLICK,{hook:e,viewSource:r.Log.viewSource.MOUSE_OVER,triggerSource:s.CLICK})})}),c.length>0&&(n.hookLoad({product:h,hookIds:e.map(c,function(e){return e.getId()}).join(",")}),a.executeCallback(h,s.NEW_HOOKS,{hooks:c,viewSource:p}))}var s={NEW_HOOKS:"newHooks",HOVER:"hover",CLICK:"click"};return c};var i=i||{};i.hook=i.hook||{},i.hook.HookAdFetcher=function(e,t,n,i,o,r,a){function c(){this.waitList={}}var s={IDLE:1,FETCHING:2},d={nodes:[],candidateNodes:[],viewSource:null,count:0,ready:!1,state:s.IDLE},u=["intext","inview"];return c.prototype.designate=function(e){this.waitList.hasOwnProperty(e)||(this.waitList[e]=n.extend({},d))},c.prototype.resolveFalse=function(e,t){this.waitList.hasOwnProperty(e)&&this.dataToFetch(e,[],[],0,t)},c.prototype.goFetch=function(e){this.waitList.hasOwnProperty(e.product)&&this.dataToFetch(e.product,e.nodes,e.candidateNodes,e.count,e.viewSource)},c.prototype.isFetching=function(e){return this.waitList[e].state===s.FETCHING},c.prototype.activeProducts=function(){return n.keys(this.waitList)},c.prototype.dataToFetch=function(e,t,n,i,o){var r=this.waitList[e];this.isFetching(e)||(r.nodes=r.nodes.concat(t),r.candidateNodes=r.candidateNodes.concat(n),r.viewSource=o,r.count=i,r.ready=!0,r.state=s.FETCHING),this.attemptFetch()},c.prototype.resetWaitList=function(){n.forOwn(this.waitList,function(e){n.extend(e,d)})},c.prototype.attemptFetch=function(){var e=this,t=!n.some(e.activeProducts(),function(t){return e.waitList[t].ready===!1});t&&this.fetch()},c.prototype.fetch=function(){var t,c=[],s={},d=[];n.forOwn(this.waitList,function(e,n){c=c.concat(e.nodes),s[n]=e.candidateNodes.slice(0),d.push(e.count),t=e.viewSource}),this.resetWaitList(),c.length&&e.request("intext",{ids:c,count:Math.max.apply(null,d),internal:n.some(r.getVisibleHooks(),function(e){var t=e.getAdConfig();return"internal"===t.ads[0].creative.creativeType&&n.includes(u,t.product)}),autoreveal:s.hasOwnProperty("inview")&&a.revealsAllowed()},function(e){var r={};n.forOwn(e,function(e,t){var n=i.hash[e[0].vibrantParameters.product];r.hasOwnProperty(n)||(r[n]={}),r[n][t]=e}),n.forOwn(r,function(e,n){o({ads:e,candidateNodes:s[n],viewSource:t,product:n})})})},new c};var i=i||{};i.hook=i.hook||{},i.hook.Behaviour=function(e,t,n,i,o,r){function a(t){this.product=t.product,this.selector=e.get("partner."+this.product+".selectors",d),this.fetchFormat=t.fetchFormat,this.callback=t.callback||!1,r.registerProduct(this.product,t.eventCallbacks),o.designate(this.product)}var c=3,s=e.getInteger("partner.intext.maxhooks",c),d=e.get("partner.intext.selectors","BODY");return a.prototype.invoke=function(e){var a=this,c=s,d=[],u=[];return this.viewSource=e.viewSource,r.hookAllowed()?(e.nodes=i.getHookableTags(e.nodes,this.selector),t.forEach(e.nodes,function(e){switch(r.getNodeStatus(a.product,e.getId())){case n.TextNode.IN_FLIGHT:--c;break;case n.TextNode.LOCKED:t.forEach(e.getHooks(),function(e){e.isInViewport()&&--c});break;default:u.push(e)}}),c<=0||0===u.length?o.resolveFalse(a.product,this.viewSource):(t.forEach(u,function(e){function i(e){d.push(t.replaceUrlParams(a.fetchFormat,e))}var o=e.getId();r.setNodeStatus(a.product,o,n.TextNode.IN_FLIGHT),a.callback?a.callback(e,o,i):i({id:o})}),void o.goFetch({product:a.product,nodes:d,count:c,viewSource:a.viewSource,candidateNodes:u}))):o.resolveFalse(a.product,this.viewSource)},a};var i=i||{};i.hook=i.hook||{},i.hook.NodeFilter=function(e,n,i){function o(e,o){function s(e){var t=e.parentNode;return!(!t||!i.isElement(t))&&(!a[t.tagName]&&((!c||!i.matchesSelector(t,c)&&!i.parentHasSelector(t,c))&&(!!n.includes(o,t)||s(t))))}return o=t.querySelectorAll(o),n.filter(e,function(e){var t;return!r[e.id]&&(t=s(e.domNode),t||(r[e.id]=!0),t)})}var r={},a={H1:!0,H2:!0,H3:!0},c=e.getArray("partner.intext.nohooknodes",!1);return{getHookableTags:o}};var i=i||{};i.hook=i.hook||{},i.hook.Mediator=function(e,t){function n(){this.nodeStatus={},this.productEventCallbacks={},this.maxPageHooks=i}var i=e.getInteger("partner.intext.pagemaxhooks",0),o=!!i;return n.prototype.getNodeStatus=function(e,t){return this.nodeStatus[e][t]},n.prototype.setNodeStatus=function(e,t,n){this.nodeStatus[e][t]=n},n.prototype.hookAllowed=function(){return!o||this.maxPageHooks>0},n.prototype.countHook=function(){o&&--this.maxPageHooks},n.prototype.registerProduct=function(e,n){this.nodeStatus[e]||(this.nodeStatus[e]={}),this.productEventCallbacks[e]||(this.productEventCallbacks[e]={}),t.extend(this.productEventCallbacks[e],n)},n.prototype.executeCallback=function(e,t,n){this.productEventCallbacks[e]&&this.productEventCallbacks[e][t]&&this.productEventCallbacks[e][t](n)},new n};var i=i||{};i.image=i.image||{};var h=3;i.image.Behaviour=function(e,t,n,i,o,a,c,s,d,u,l){function p(){var e=n.get("partner.image",{});switch(e.get("caption.strategy",null)){case"bruteForce":this.captionStrategy=new d.BruteForce(e.getInteger("caption.maxdepth",h));break;case"cssSelector":this.captionStrategy=new d.CssSelector(e.get("caption.selector"));break;default:this.captionStrategy=null}}var f=n.getInteger("partner.image.pagemaxhooks",0),g=!!f;return p.prototype=new a.Observable,p.prototype.invoke=function(a){function p(e,t,n){c.adClose({product:e.product,hookId:e.settings.vibrantParameters.hookId,source:t||r.Log.closeSource.AUTO}),n()}function h(e,n,i){e=t.decoration.decorate(e,{decorationType:y}),c.adImpression({product:e.product,hookId:e.settings.vibrantParameters.hookId,setId:e.settings.vibrantParameters.setId,source:n}),i()}var v=a.hooks,m=this,y="image",b=u.map(v,function(e){return e.getId()+":"+e.getWidth()+":"+e.getHeight()});g&&f<1||e.request("image",{ids:b,count:a.maxAds},function(e){var b=[];u.forEach(v,function(c){function u(e,n){e.position=new t.position.Absolute(function(){return d.findPositionWithinImage(c.getDomNode(),w,m.captionStrategy)}),n(null,e)}var v,w,k,E=c.getId();if(e.hasOwnProperty(E)){if(g){if(f<1)return;--f}v=e[E][0],v.container={width:c.getWidth(),height:c.getHeight()},w=t.adunit.create({product:"image",settings:v,templateSettings:{cdnUrl:"//"+n.cdn.internal,id:v.ads[0].creative.value},creativeLoad:function(e){var t=i.waterfall.select(e,"image",y);return y=t.decoration,t.creative},render:u,open:h,close:p}),o.onPositionChange(c.getDomNode(),function(){w.fire("domChange"),k||(!c.isVisible()&&w.isOpen()&&w.fire("hide"),c.isVisible()&&!w.isOpen()&&w.fire("show"))}),l.on(r.app.inview.animationStart,function(){k=!0,w.fire("hide")}),l.on(r.app.inview.animationEnd,function(){w.fire("domChange"),w.fire("show"),k=!1}),a.gallery&&m.fire("galleryBehaviour",{adUnit:w}),c.setAdUnit(w),s.track(w,v.trackers,v.term),w.connect("opened",w,"impression"),w.connect(w.EVENT_CLICK,w,"click"),w.fire("open",a.viewSource),b.push(v.vibrantParameters.hookId)}}),b.length>0&&c.hookLoad({product:"image",hookIds:b.join(",")})})},p};var i=i||{};i.image=i.image||{},i.image.Deviations=function(e,t){function n(e,n){return t.forEach(r,function(t){t.value&&(n=t.func(e,n,t.value))}),n}function i(e,n,i){return t.forOwn(n,function(e,t){i.hasOwnProperty(t)&&(n[t]+=parseInt(i[t],10)||0)}),n}var o=e.get("partner.image",{}),r=[{func:i,value:o.get("pos",!1)}];return{applyRules:n}};var i=i||{};i.image=i.image||{},i.image.Gallery=function(e){function t(t){e.Observable.call(this),this.channel=t.api.channel}return t.prototype=new e.Observable,t.prototype.invoke=function(e){e.adUnit&&this.channel.fire("newAd",{ad:e.adUnit})},t};var i=i||{};i.image=i.image||{},i.image.Position=function(e,t,n,i){function o(e){this.maxDepth=e}function a(e){this.selector=e}function c(e,n,o){var r,a=t.getPosition(e),c=a.right-a.left,s=n.width||n.getWidth(),d=n.height||n.getHeight(),u=new t.Coord({top:a.bottom-d,left:a.left+(c-s)/2,bottom:a.bottom,right:a.right-(c-s)/2});return o&&(r=o.findCaptionTop(e,u),r&&u.shiftY(r-a.bottom)),i.applyRules(e,u)}return o.prototype.findCaptionTop=function(e,i){function o(e){if(e.nodeType===r.Dom.ELEMENT_NODE&&"vm-adunit-outer"!==e.className&&t.isVisible(e)){var a=t.getPosition(e);a.top<c&&i.getIntersection(a)&&(c=a.top),n.forEach(e.childNodes,o)}}for(var a=0,c=1/0;a<this.maxDepth;){var s=e.parentNode;if(!s)break;for(var d=s.childNodes,u=0,l=d.length;u<l;++u)d[u]!==e&&o(d[u]);e=s,++a}return isFinite(c)?c:null},a.prototype.findCaptionTop=function(i,o){var r=e.querySelectorAll(this.selector),a=1/0;return n.forEach(r,function(e){var n=t.getPosition(e);t.isVisible(e)&&n.getIntersection(o)&&(a=n.top)}),isFinite(a)?a:null},{findPositionWithinImage:c,BruteForce:o,CssSelector:a}};var i=i||{};i.inview=i.inview||{},i.inview.Filter=function(e,t,n){function i(e){var t,i,u,p={allowed:!1,width:null};if(!n.isElement(e))return p;if(t=n.getTextNodeBounds(e),i=t.getWidth(),i<r)return p;if(n.elementHasNodes(e,c))return p;if(l&&n.parentHasSelector(e,l.split(",")))return p;if(d&&o(e))return p;if(u=n.nextElementSibling(e)){if(u.className.indexOf(a)!==-1)return p;if(s&&n.matchesSelector(u,s))return p}return{allowed:!0,width:i}}function o(e){var i=n.elementsAtPoints(e,u),o="IMG";return t.some(i,function(e){return!!n.isElement(e)&&e.tagName===o})}var r="mobile"===e.platform?280:400,a="tt-wrapper",c=e.getArray("partner.inview.blockednodes",["img","div","iframe"]),s=e.get("partner.inview.avoid",null),d=e.getBoolean("partner.inview.collisiondetect",!0),u=e.getInteger("partner.inview.collisionoffset",10),l=e.get("partner.inview.blockbyparent",null);return i};var i=i||{};i.inview=i.inview||{},i.inview.Behaviour=function(e,t,n,i,o,a,c,s,u,l,p,h){function f(){var e=this;this.activeHook=null,this.activeUnit=null,y&&p.on(r.app.intext.tooltipClose,function(){e.closeOpenUnits()})}var g,v=100,m=1e3,y=n.getBoolean("partner.inview.closeonopen",!1);return f.prototype=new c.Observable,f.prototype.processNode=function(e,t,n){var i=a.findParentParagraph(e.getDomNode()),o=h(i);o.allowed&&n({id:t,width:Math.floor(o.width)})},f.prototype.closeOpenUnits=function(){this.activeUnit&&(g=this.activeUnit.getPosition(),this.activeUnit.fire("close",r.Log.closeSource.AUTO))},f.prototype.invoke=function(e){function o(e,t,n){h.disconnectAll(b),s.adClose({product:e.product,hookId:e.settings.vibrantParameters.hookId,source:t||r.Log.closeSource.AUTO}),n()}function c(e,n){e.position=new t.position.Inview(h),n(null,e)}function l(e,i,o){var r,c=a.getAbsoluteViewport(),d=function(){var t=0;return g?g.top>e.position.hook.getPosition().bottom?t:(t=g.getHeight(),g=null,t):t}();e=t.decoration.decorate(e,{decorationType:y}),p(e),s.adImpression({product:e.product,hookId:e.settings.vibrantParameters.hookId,setId:e.settings.vibrantParameters.setId,source:i}),n.getBoolean("mobile",!1)?r=b.getPosition().top+b.getHeight()/2-(c.top+c.bottom)/2-d:(r=b.getPosition().top+b.getHeight()+v-c.bottom,r=Math.max(0,r),r+=-d),0!==r&&a.smoothScrollY(r,m),o()}function p(e){var t=e.template.params,n=e.outerBox.querySelector(".vm-adunit-content");t.backgroundColor&&(n.style.backgroundColor=t.backgroundColor)}var h=e.hook,f=h.getAdConfig();if(h!==this.activeHook||!this.activeUnit.isOpen()){var y="inview";f.container={width:h.getParagraphPosition().getWidth()};var b=t.adunit.create({product:"inview",settings:f,templateSettings:{cdnUrl:"//"+n.cdn.internal,id:f.ads[0].creative.value},creativeLoad:function(e){var t=i.waterfall.select(e,"inview",y);return y=t.decoration,t.creative},render:c,open:l,close:o});u.track(b,f.trackers,f.term),b.connect("opened",b,"impression"),b.connect(b.EVENT_CLICK,b,"click"),h.connect(d.Hook.EVENT_HOOKIN,b,b.EVENT_MOUSEIN),h.connect(d.Hook.EVENT_HOOKOUT,b,b.EVENT_MOUSEOUT),h.connect(d.Hook.EVENT_CLICK,b,b.EVENT_CLICK),!n.mobile&&e.triggerSource&&b.once("opened",function(){b.fire("delegate",{triggerSource:e.triggerSource,source:r.Log.clickSource.HOOK})}),this.closeOpenUnits(),b.fire("open",e.viewSource),this.activeHook=h,this.activeUnit=b}},f};var f=f||"VM";e[f]=e[f]||{},e[f].initialise=function(a){var u=r.Utils(),h=c.ProductMap(),g=c.CompatibilityRules(u);a=r.Config(a,u,g);var v=a.apiVersions;r.PubXBuilder(a);var m=r.Events(u),y=r.AppChannel(m),b=r.AdsMonitor(y),w=r.Dom(e,t,m,u),k=r.Log(v,a,w,u),E=function(){var n=o.Mediator(u,y),i=c.BidDetails(e,u);return o.Loader(e,t,a,u,w,k,i,n)(),n}(),O=r.Cookie(t,a),C=r.CookieSync(v,a,w,u,k),I=r.Api(e,v,a,w,m,u,k,b,E),N=r.AdFetcher(I,y,u,a),S=r.PubX(k),T=r.Page(I,a,u),x=r.Net(e,f,w,m,u),L=r.Tracking(a,x,u,k,y),A=r.Waterfall(e,t,a,u,k),P=function(){var i=n.Template(x,u);return{template:i,creative:n.Creative(m,u),position:n.Position(e,t,w,m,u,y),adunit:n.AdUnit(e,w,m,i),videounit:n.VideoUnit(e,t,a,w,m,k,u),cpeunit:n.CPEUnit(e,a,w,m,k,u),customunit:n.CustomUnit(e,a,w,m,k,u,n.VideoUnit),decoration:n.Decoration(e,t,a,m,w,u,k)}}(),H=function(){var e=s.Waterfall({standard:s.Standard(P.creative,m,k,u),c2s:s.C2S(P.creative,w,m,k),banner:s.Banner(P.creative,w,k,u),video:s.Video(P.creative,P.videounit,m,k),cpe:s.CPE(P.creative,P.cpeunit,m,k),custom:s.Custom(P.creative,P.customunit,m,k)});return{waterfall:e}}(),D=function(){var e=d.Hook(t,a,w,m,u,h),n=d.Image(w,m,u),i=d.Paragraph(w,u),o=d.TextNode(t,u);return{hook:e,image:n,paragraph:i,textNode:o}}(),U=r.ContentMonitor(N,a,w,D.image,k,T,D.textNode,u),_={Adhesion:p.Adhesion(m),Image:p.Image(m,u),Gallery:p.Gallery(e,a,m,u,w,D.image,N),ParagraphBreak:p.ParagraphBreak(D.paragraph,m,A),TextNode:p.TextNode(a,w,m,u),Scroll:p.Scroll(y,w,m),Resize:p.Resize(y,m,u),Gesture:p.Gesture(y,m,w,u)},V=function(){var n=i.AutoReveal(a,u,O,y);return{AdhesionPlacement:i.AdhesionPlacement(P,a,H,w,m,k,L,u),AdhesionBackfill:i.AdhesionBackfill(N,w,m,u,a),AdBarLegacy:i.AdBarLegacy(e,a,w),AdBar:i.AdBar(N,P,a,H,m,k,L),AutoReveal:n,ScriptsLoader:i.ScriptsLoader(a,u),DropInPlacement:i.DropInPlacement(P,a,H,m,k,L),InView:function(){var t=i.inview.Filter(a,u,w);return i.inview.Behaviour(e,P,a,H,O,w,m,k,L,u,y,t)}(),Daw:i.Daw(N,P,a,H,m,k,L),Image:function(){var e=i.image.Deviations(a,u),n=i.image.Position(t,w,u,e);return i.image.Behaviour(N,P,a,H,w,m,k,L,n,u,y)}(),Gallery:i.image.Gallery(m),Inline:i.Inline(N,P,a,H,m,k,L,A),Tooltip:i.Tooltip(e,P,a,H,w,m,k,u,L,y),Hook:function(){var e=i.hook.Mediator(a,u),t=i.hook.AdAssign(u,m,k,D.hook,D.textNode,e),o=i.hook.HookAdFetcher(N,m,u,h,t,D.hook,n),r=i.hook.NodeFilter(a,u,w);return i.hook.Behaviour(a,u,D.textNode,r,o,e)}(),VibrantView:i.VibrantView(a,O,m,u),Wordflip:i.Wordflip(e,t,a,u,w,m,D.hook,y)}}();y.once(r.app.main.initialise,function(e){var t,n=e.data.pubXReached;n&&S.set(a.getInteger("partner.pubx.action",r.PubX.ALLOW_ALL)),t=l[a.get("platform")](V,a,S,_,D.hook,u).initialise(),u.forEach(a.getArray("partner.products"),function(e){t.hasOwnProperty(e)&&!A.isBlocked(e)&&t[e](y,e)})}),function(){function n(){w.waitForReadyState(function(){U.run(y),k.pageTracking({referrer:u.Base64.encodeURI(t.referrer)})})}var i=a.get("partner.rundelay",0),o=a.get("partner.hook.style.custom",null);C.sync(),w.appendStyleSheet("//"+a.cdn.kormorantcss.replace("{{version}}",a.version)),o&&w.appendInlineStyle(o),i>0?e.setTimeout(n,i):n()}()}}(window,document);